{% load i18n %}
{% load static %}
<!DOCTYPE html>
{% get_current_language as CURRENT_LANGUAGE %}
<html lang="{{ CURRENT_LANGUAGE }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="{% static 'transcribe/favicon.ico' %}">
    <link rel="icon" type="image/png" href="{% static 'transcribe/favicon.png' %}">
    <title>{% trans "–ß–µ—Å—Ç–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≤–∞—à–∏—Ö –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤" %}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Arial Black', Arial, sans-serif;
            background: #fff;
            color: #000;
            line-height: 1.6;
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            transition: all 0.3s ease;
        }
        
        /* –ö—Ä–∞—Å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏ –±–∞–ª–∞–Ω—Å–µ 0 */
        body.zero-balance {
            background: #ffebee !important;
        }
        
        body.zero-balance .container,
        body.zero-balance .sidebar {
            border-color: #d32f2f !important;
            box-shadow: 8px 8px 0 #d32f2f !important;
        }
        
        body.zero-balance .header {
            background: #d32f2f !important;
            border-color: #b71c1c !important;
        }
        
        body.zero-balance .upload-area {
            border-color: #d32f2f !important;
            background: #ffebee !important;
        }
        
        body.zero-balance .btn-primary {
            background: #d32f2f !important;
            border-color: #b71c1c !important;
        }
        
        body.zero-balance .btn-primary:hover {
            background: #b71c1c !important;
        }
        
        body.zero-balance .sidebar-group input,
        body.zero-balance .sidebar-group select {
            border-color: #d32f2f !important;
        }
        
        body.zero-balance .transcription-item {
            border-color: #d32f2f !important;
        }
        
        .main-wrapper {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .container {
            flex: 1;
            background: #fff;
            border: 4px solid #000;
            box-shadow: 8px 8px 0 #000;
        }
        
        .sidebar {
            width: 300px;
            background: #fff;
            border: 4px solid #000;
            box-shadow: 8px 8px 0 #000;
            padding: 20px;
            position: sticky;
            top: 20px;
            height: fit-content;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }
        
        .sidebar-title {
            font-size: 18px;
            font-weight: 900;
            text-transform: uppercase;
            margin-bottom: 20px;
            border-bottom: 3px solid #000;
            padding-bottom: 10px;
        }
        
        .sidebar-group {
            margin-bottom: 20px;
        }
        
        .sidebar-group label {
            display: block;
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 8px;
            color: #000;
        }
        
        .sidebar-group input,
        .sidebar-group select {
            width: 100%;
            padding: 10px;
            border: 3px solid #000;
            font-weight: 700;
            font-size: 14px;
            background: #fff;
        }
        
        .sidebar-group .info-text {
            font-size: 11px;
            margin-top: 5px;
            opacity: 0.8;
            font-weight: 600;
        }
        
        .sidebar-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        
        .sidebar-checkbox input[type="checkbox"] {
            width: auto;
            height: 20px;
            cursor: pointer;
        }
        
        .burger-menu {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: #ff6b6b;
            border: 4px solid #000;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 4px 4px 0 #000;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 900;
        }
        
        .burger-menu:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
        }
        
        .sidebar-overlay.active {
            display: block;
        }
        
        @media (max-width: 1024px) {
            .main-wrapper {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                position: static;
                max-height: none;
            }
        }
        
        @media (max-width: 768px) {
            .burger-menu {
                display: flex;
            }
            
            .sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: 280px;
                height: 100vh;
                z-index: 1002;
                transition: left 0.3s ease;
                max-height: 100vh;
                overflow-y: auto;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            body {
                padding: 80px 10px 10px 10px;
            }
        }
        
        .header {
            background: #ff6b6b;
            color: #000;
            padding: 10px 30px;
            text-align: center;
            border-bottom: 4px solid #000;
            position: relative;
        }
        
        .header h1 {
            font-size: clamp(12.6px, 2.2vw, 22.68px);
            font-weight: 900;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: -1px;
            animation: textDance 2s ease-in-out infinite;
            text-align: left;
            line-height: 1.2;
        }
        
        .header .subtitle {
            font-size: clamp(11px, 1.5vw, 14px);
            font-weight: 600;
            opacity: 0.9;
            text-transform: lowercase;
            animation: textPulse 3s ease-in-out infinite;
        }
        
        @keyframes textDance {
            0%, 100% {
                transform: translateY(0) rotate(0deg) scale(1);
                text-shadow: 2px 2px 0 #000, 4px 4px 0 #ffd93d;
            }
            25% {
                transform: translateY(-3px) rotate(-1deg) scale(1.02);
                text-shadow: 3px 3px 0 #000, 6px 6px 0 #6bcf7f, 8px 8px 0 #ffd93d;
            }
            50% {
                transform: translateY(0) rotate(0deg) scale(1);
                text-shadow: 2px 2px 0 #000, 4px 4px 0 #ffd93d;
            }
            75% {
                transform: translateY(-3px) rotate(1deg) scale(1.02);
                text-shadow: 3px 3px 0 #000, 6px 6px 0 #4d9de0, 8px 8px 0 #ffd93d;
            }
        }
        
        @keyframes textPulse {
            0%, 100% {
                opacity: 0.8;
                transform: translateY(0);
            }
            50% {
                opacity: 1;
                transform: translateY(-2px);
            }
        }
        
        .upload-section {
            padding: 30px;
            border-bottom: 4px solid #000;
        }
        
        /* –°–µ–∫—Ü–∏—è –≤—Ö–æ–¥–∞ */
        .login-section {
            background: #ffd93d;
            padding: 20px;
            border: 4px solid #000;
            margin-bottom: 20px;
            box-shadow: 4px 4px 0 #000;
        }
        
        .login-section.logged-in {
            background: #6bcf7f;
        }
        
        .login-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .login-title {
            font-weight: 900;
            color: #000;
            font-size: clamp(16px, 3vw, 20px);
            text-transform: uppercase;
        }
        
        .login-status {
            padding: 8px 16px;
            border: 3px solid #000;
            font-size: 14px;
            font-weight: 900;
            background: #000;
            color: #fff;
        }
        
        .login-form {
            display: flex;
            gap: 10px;
            align-items: flex-end;
            flex-wrap: wrap;
        }
        
        .login-form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .login-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 900;
            color: #000;
            font-size: 14px;
            text-transform: uppercase;
        }
        
        .login-form-group input {
            width: 100%;
            padding: 12px;
            border: 3px solid #000;
            border-radius: 0;
            font-size: 16px;
            font-weight: 700;
            background: #fff;
            box-shadow: 3px 3px 0 #000;
        }
        
        .login-form-group input:focus {
            outline: none;
            box-shadow: 5px 5px 0 #000;
            transform: translate(-2px, -2px);
        }
        
        .btn-login, .btn-logout {
            padding: 12px 24px;
            border: 3px solid #000;
            font-size: 16px;
            font-weight: 900;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.1s;
            box-shadow: 4px 4px 0 #000;
        }
        
        .btn-login {
            background: #6bcf7f;
            color: #000;
        }
        
        .btn-logout {
            background: #ff6b6b;
            color: #000;
        }
        
        .btn-login:hover, .btn-logout:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .btn-login:active, .btn-logout:active {
            transform: translate(4px, 4px);
            box-shadow: 0 0 0 #000;
        }
        
        .info-text {
            font-size: 12px;
            color: #000;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .upload-form-wrapper {
            margin-bottom: 30px;
        }
        
        .upload-form {
            background: #fff;
            padding: 30px;
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
        }
        
        .upload-area {
            border: 4px dashed #000;
            padding: 60px 20px;
            text-align: center;
            background: #f5f5f5;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 20px;
            position: relative;
        }
        
        .upload-area:hover {
            background: #ffd93d;
            transform: translate(-2px, -2px);
            box-shadow: 4px 4px 0 #000;
        }
        
        .upload-area.dragover {
            background: #6bcf7f;
            border-color: #000;
            transform: scale(1.02);
        }
        
        .upload-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .upload-text {
            font-size: 18px;
            font-weight: 700;
            color: #000;
            line-height: 1.6;
        }
        
        .file-list {
            margin-top: 20px;
            text-align: left;
        }
        
        .file-item {
            background: #fff;
            border: 3px solid #000;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
        }
        
        .file-item-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .file-item-size {
            margin-left: 15px;
            color: #666;
            font-size: 14px;
        }
        
        .file-item-remove {
            background: #ff6b6b;
            color: #000;
            border: 2px solid #000;
            padding: 5px 10px;
            cursor: pointer;
            font-weight: 900;
            margin-left: 10px;
        }
        
        .file-item-remove:hover {
            transform: scale(1.1);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 900;
            color: #000;
            font-size: 16px;
            text-transform: uppercase;
        }
        
        .form-group input[type="file"],
        .form-group input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 3px solid #000;
            border-radius: 0;
            font-size: 16px;
            font-weight: 700;
            background: #fff;
            box-shadow: 3px 3px 0 #000;
            transition: all 0.1s;
        }
        
        .form-group input[type="file"]:focus,
        .form-group input[type="text"]:focus {
            outline: none;
            box-shadow: 5px 5px 0 #000;
            transform: translate(-2px, -2px);
        }
        
        /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã */
        .upload-progress-container {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #fff;
            border: 3px solid #000;
            box-shadow: 4px 4px 0 #000;
        }
        
        .upload-progress-container.active {
            display: block;
        }
        
        .upload-progress-label {
            font-weight: 900;
            margin-bottom: 15px;
            color: #000;
            font-size: 18px;
            text-transform: uppercase;
        }
        
        .upload-progress-bar {
            width: 100%;
            height: 40px;
            background: #fff;
            border: 3px solid #000;
            overflow: hidden;
            position: relative;
            box-shadow: 3px 3px 0 #000;
        }
        
        .upload-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6bcf7f 0%, #4d9de0 50%, #6bcf7f 100%);
            background-size: 200% 100%;
            animation: progressShine 2s linear infinite;
            width: 0%;
            transition: width 0.2s ease-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: 900;
            font-size: 16px;
            border-right: 3px solid #000;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes progressShine {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
        
        .upload-progress-text {
            margin-top: 15px;
            text-align: center;
            color: #000;
            font-size: 14px;
            font-weight: 700;
        }
        
        .transcription-progress-container {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #ffd93d;
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
        }
        
        .transcription-progress-container.active {
            display: block;
        }
        
        .transcription-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .transcription-progress-title {
            font-weight: 900;
            color: #000;
            font-size: clamp(16px, 3vw, 20px);
            text-transform: uppercase;
        }
        
        .transcription-status {
            padding: 8px 16px;
            border: 3px solid #000;
            font-size: 14px;
            font-weight: 900;
        }
        
        .status-pending {
            background: #ffd93d;
            color: #000;
        }
        
        .status-processing {
            background: #4d9de0;
            color: #000;
            animation: pulse 1s infinite;
        }
        
        .status-completed {
            background: #6bcf7f;
            color: #000;
        }
        
        .status-error {
            background: #ff6b6b;
            color: #000;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .transcription-progress-bar {
            width: 100%;
            height: 35px;
            background: #fff;
            border: 3px solid #000;
            overflow: hidden;
            position: relative;
            margin-bottom: 10px;
            box-shadow: 3px 3px 0 #000;
        }
        
        .transcription-progress-fill {
            height: 100%;
            background: #6bcf7f;
            width: 0%;
            transition: width 0.5s ease;
            border-right: 3px solid #000;
        }
        
        .transcription-progress-text {
            text-align: center;
            color: #000;
            font-size: 14px;
            font-weight: 700;
            margin-top: 10px;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 4px solid #000;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .btn {
            background: #6bcf7f;
            color: #000;
            border: 4px solid #000;
            padding: 18px 40px;
            font-size: 18px;
            font-weight: 900;
            border-radius: 0;
            cursor: pointer;
            transition: all 0.1s;
            width: 100%;
            text-transform: uppercase;
            box-shadow: 6px 6px 0 #000;
        }
        
        .btn:hover:not(:disabled) {
            transform: translate(4px, 4px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .btn:active:not(:disabled) {
            transform: translate(6px, 6px);
            box-shadow: 0 0 0 #000;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .transcriptions-section {
            padding: 30px;
        }
        
        .transcriptions-section h2 {
            margin-bottom: 25px;
            color: #000;
            font-size: clamp(24px, 4vw, 32px);
            font-weight: 900;
            text-transform: uppercase;
            border-bottom: 4px solid #000;
            padding-bottom: 10px;
            animation: textDance 2s ease-in-out infinite;
        }
        
        .transcription-item {
            background: #fff;
            padding: 25px;
            margin-bottom: 20px;
            border: 4px solid #000;
            box-shadow: 6px 6px 0 #000;
            transition: all 0.1s;
        }
        
        .transcription-item:hover {
            transform: translate(4px, 4px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .transcription-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .transcription-filename {
            font-weight: 900;
            color: #000;
            font-size: clamp(16px, 3vw, 20px);
            text-transform: uppercase;
        }
        
        .transcription-date {
            color: #000;
            font-size: 14px;
            font-weight: 700;
        }
        
        .transcription-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #000;
            font-weight: 700;
            flex-wrap: wrap;
        }
        
        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border: 3px solid #000;
            font-size: 12px;
            font-weight: 900;
            text-transform: uppercase;
        }
        
        .transcription-preview {
            margin-top: 15px;
            padding: 20px;
            background: #f5f5f5;
            border: 3px solid #000;
            max-height: 150px;
            overflow: hidden;
            font-weight: 600;
            line-height: 1.8;
        }
        
        .view-full {
            display: inline-block;
            margin-top: 15px;
            color: #000;
            text-decoration: none;
            font-weight: 900;
            font-size: 16px;
            text-transform: uppercase;
            border-bottom: 3px solid #000;
            padding-bottom: 2px;
        }
        
        .view-full:hover {
            background: #ffd93d;
            padding: 5px 10px;
            border: 3px solid #000;
            box-shadow: 3px 3px 0 #000;
        }
        
        .message {
            padding: 20px;
            margin-bottom: 20px;
            border: 4px solid #000;
            display: none;
            font-weight: 700;
            box-shadow: 4px 4px 0 #000;
        }
        
        .message.success {
            background: #6bcf7f;
            color: #000;
        }
        
        .message.error {
            background: #ff6b6b;
            color: #000;
        }
        
        .message.active {
            display: block;
        }
        
        .empty-state {
            text-align: center;
            color: #000;
            padding: 60px 20px;
            font-size: 18px;
            font-weight: 700;
            border: 4px solid #000;
            background: #f5f5f5;
            box-shadow: 4px 4px 0 #000;
        }
        
        .disk-info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.85);
            color: #fff;
            padding: 15px 20px;
            border: 4px solid #fff;
            font-weight: 900;
            font-size: 14px;
            z-index: 100;
            box-shadow: 4px 4px 0 #fff;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            min-width: 250px;
        }
        
        .disk-info.collapsed {
            padding: 10px 15px;
        }
        
        .disk-info.collapsed .disk-info-content {
            display: none;
        }
        
        .disk-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            margin-bottom: 10px;
        }
        
        .disk-info-title {
            text-transform: uppercase;
            font-size: 12px;
            flex: 1;
        }
        
        .disk-info-toggle {
            background: #fff;
            color: #000;
            border: 2px solid #000;
            padding: 4px 8px;
            font-weight: 900;
            font-size: 12px;
            cursor: pointer;
            margin-left: 10px;
        }
        
        .disk-info-toggle:hover {
            background: #ffd93d;
        }
        
        .disk-info-content {
            transition: opacity 0.3s;
        }
        
        .disk-info-language-section {
            margin-bottom: 10px;
        }
        
        .disk-info-language-section select {
            color: #fff !important;
        }
        
        .disk-info-language-section select option {
            background: #000;
            color: #fff;
        }
        
        .disk-info-value {
            font-size: 18px;
            color: #6bcf7f;
            margin-bottom: 8px;
        }
        
        .disk-bar {
            width: 100%;
            height: 20px;
            background: #333;
            border: 2px solid #fff;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .disk-bar-fill {
            height: 100%;
            background: #6bcf7f;
            transition: width 0.3s;
        }
        
        .disk-bar-fill.warning {
            background: #ffd93d;
        }
        
        .disk-bar-fill.danger {
            background: #ff6b6b;
        }
        
        .disk-clear-btn {
            margin-top: 10px;
            background: #ff6b6b;
            color: #000;
            border: 3px solid #fff;
            padding: 8px 15px;
            font-weight: 900;
            font-size: 12px;
            cursor: pointer;
            text-transform: uppercase;
            width: 100%;
            box-shadow: 3px 3px 0 #fff;
        }
        
        .disk-clear-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0 #fff;
        }
        
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .password-modal.active {
            display: flex;
        }
        
        .password-modal-content {
            background: #fff;
            padding: 30px;
            border: 4px solid #000;
            box-shadow: 8px 8px 0 #000;
            max-width: 400px;
            width: 90%;
        }
        
        .password-modal-content h3 {
            margin: 0 0 20px 0;
            font-weight: 900;
            text-transform: uppercase;
        }
        
        .password-modal-content input {
            width: 100%;
            padding: 12px;
            border: 3px solid #000;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .password-modal-buttons {
            display: flex;
            gap: 10px;
        }
        
        .password-modal-btn {
            flex: 1;
            padding: 12px;
            border: 3px solid #000;
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
        }
        
        .password-modal-btn.confirm {
            background: #ff6b6b;
        }
        
        .password-modal-btn.cancel {
            background: #6bcf7f;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ–ø–ª–∞—Ç—ã */
        .payment-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .payment-modal.active {
            display: flex;
        }
        
        .payment-modal-content {
            background: #fff;
            padding: 30px;
            border: 4px solid #000;
            box-shadow: 8px 8px 0 #000;
            max-width: 500px;
            width: 90%;
        }
        
        .payment-modal-content h3 {
            margin: 0 0 20px 0;
            font-weight: 900;
            text-transform: uppercase;
        }
        
        .payment-modal-content .form-group {
            margin-bottom: 20px;
        }
        
        .payment-modal-content .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            font-size: 14px;
        }
        
        .payment-modal-content .form-group input {
            width: 100%;
            padding: 12px;
            border: 3px solid #000;
            font-size: 16px;
            font-weight: 700;
            box-sizing: border-box;
        }
        
        .payment-modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .payment-modal-btn {
            flex: 1;
            padding: 12px;
            border: 3px solid #000;
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
            font-size: 16px;
        }
        
        .payment-modal-btn.confirm {
            background: #6bcf7f;
        }
        
        .payment-modal-btn.cancel {
            background: #ff6b6b;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 80px 10px 10px 10px;
            }
            
            .container {
                border-width: 3px;
                box-shadow: 4px 4px 0 #000;
            }
            
            .header {
                padding: 25px 20px;
            }
            
            .upload-section,
            .transcriptions-section {
                padding: 20px;
            }
            
            .form-group input,
            .btn {
                font-size: 16px;
            }
            
            .transcription-item {
                padding: 15px;
            }
        }
        
    </style>
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105456934', 'ym');

        ym(105456934, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/105456934" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
</head>
<body>
    <div class="burger-menu" id="burgerMenu" onclick="toggleSidebar()">‚ò∞</div>
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    
    <div class="main-wrapper">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-title">‚öôÔ∏è {% trans "–Ω–∞—Å—Ç—Ä–æ–π–∫–∏" %}</div>
            <div style="padding: 10px; background: #f5f5f5; border: 2px solid #000; margin: 10px 0; font-size: 12px; font-weight: 700;">
                <div style="margin-bottom: 5px;">UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</div>
                <div id="userUUIDDisplay" style="font-family: monospace; word-break: break-all; color: #4d9de0;"></div>
            </div>
            
            <div class="sidebar-group">
                <label class="sidebar-checkbox">
                    <input type="checkbox" id="extract_screenshots" name="extract_screenshots">
                    <span>{% trans "–≤—ã–Ω—É—Ç—å —Å–∫—Ä–∏–Ω—ã –∏–∑ –≤–∏–¥–µ–æ (1 —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É)" %}</span>
                </label>
            </div>
            
            <div class="sidebar-group">
                <label for="whisper_model">{% trans "–º–æ–¥–µ–ª—å –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏:" %}</label>
                <select id="whisper_model" name="whisper_model">
                    <option value="base" selected>{% trans "Base (–±–∞–ª–∞–Ω—Å, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)" %}</option>
                    <option value="tiny">{% trans "Tiny (–±—ã—Å—Ç—Ä–∞—è, –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)" %}</option>
                    <option value="small">{% trans "Small (—Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)" %}</option>
                    <option value="medium">{% trans "Medium (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)" %}</option>
                    <option value="large-v2">{% trans "Large-v2 (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –º–µ–¥–ª–µ–Ω–Ω–æ)" %}</option>
                    <option value="large-v3">{% trans "Large-v3 (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –º–µ–¥–ª–µ–Ω–Ω–æ)" %}</option>
                </select>
                <div class="info-text">{% trans "–≤—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å: –±—ã—Å—Ç—Ä–∞—è = –º–µ–Ω—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å, –º–µ–¥–ª–µ–Ω–Ω–∞—è = –±–æ–ª—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å" %}</div>
            </div>
            
            <div class="sidebar-group">
                <label for="signature">{% trans "–ø–æ–¥–ø–∏—Å—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):" %}</label>
                <input type="text" id="signature" name="signature" placeholder="{% trans "–≤–≤–µ–¥–∏—Ç–µ –ø–æ–¥–ø–∏—Å—å..." %}">
            </div>
            
            <div class="sidebar-group">
                <label for="password_phrase">{% trans "—Ñ—Ä–∞–∑–∞-–ø–∞—Ä–æ–ª—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):" %}</label>
                <input type="text" id="password_phrase" name="password_phrase" placeholder="{% trans "–≤–≤–µ–¥–∏—Ç–µ —Ñ—Ä–∞–∑—É-–ø–∞—Ä–æ–ª—å –¥–ª—è –∑–∞—â–∏—Ç—ã..." %}" value="{% if is_logged_in %}{{ active_phrase }}{% endif %}">
                <div class="info-text">{% trans "–µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å —Ñ—Ä–∞–∑—É-–ø–∞—Ä–æ–ª—å, —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ —Ç–µ–º, –∫—Ç–æ –≤–æ–π–¥–µ—Ç –ø–æ —ç—Ç–æ–π —Ñ—Ä–∞–∑–µ" %}</div>
            </div>
        </div>
        
        <div class="container">
        <div class="header">
            <h1>{% trans "—á–µ—Å—Ç–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è" %}<br>{% trans "–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤" %}</h1>
            <div class="subtitle">{% trans "–ø–µ—Ä–µ–≤–µ–¥—ë–º –≤–∞—à–µ –∞—É–¥–∏–æ –∏–ª–∏ –≤–∫—Å –≤–∏–¥–µ–æ –≤ —Ç–µ–∫—Å—Ç. —á–µ—Å—Ç–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥, –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–∏—Å" %}</div>
        </div>
        
        <div class="upload-section">
            <!-- –£–ª—É—á—à–µ–Ω–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ -->
            <div class="upload-form-wrapper">
                <div class="message" id="message"></div>
                <form class="upload-form" id="uploadForm" enctype="multipart/form-data" novalidate>
                    {% csrf_token %}
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-text">
                            <strong>{% trans "–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞" %}</strong><br>
                            {% trans "–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞" %}
                        </div>
                        <input type="file" id="file" name="file" accept="audio/*,video/*" multiple style="display: none;">
                        <div class="file-list" id="fileList"></div>
                    </div>
                    <button type="submit" class="btn" id="submitBtn">
                        <span id="btnText">{% trans "–∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å" %}</span>
                        <span id="btnSpinner" style="display: none;" class="spinner"></span>
                    </button>
                </form>
            </div>
            
            <!-- –°–µ–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é -->
            <div class="login-section {% if is_logged_in %}logged-in{% endif %}" id="loginSection" style="margin-top: 30px;">
                <div class="login-header">
                    <div class="login-title">üîê {% trans "–≤—Ö–æ–¥ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é" %}</div>
                    {% if is_logged_in %}
                    <span class="login-status">{% trans "–≤—Ö–æ–¥:" %} {{ active_phrase }}</span>
                    {% endif %}
                </div>
                {% if not is_logged_in %}
                <form class="login-form" id="loginForm">
                    {% csrf_token %}
                    <div class="login-form-group">
                        <label for="login_phrase">{% trans "—Ñ—Ä–∞–∑–∞-–ø–∞—Ä–æ–ª—å:" %}</label>
                        <input type="text" id="login_phrase" name="password_phrase" placeholder="{% trans "–≤–≤–µ–¥–∏—Ç–µ —Ñ—Ä–∞–∑—É..." %}" required>
                    </div>
                    <button type="submit" class="btn-login">{% trans "–≤–æ–π—Ç–∏" %}</button>
                </form>
                <div class="info-text">{% trans "–≤–æ–π–¥–∏—Ç–µ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å —ç—Ç–æ–π —Ñ—Ä–∞–∑–æ–π" %}</div>
                {% else %}
                <form class="login-form" id="logoutForm">
                    {% csrf_token %}
                    <div class="login-form-group" style="flex: 1;">
                        <div class="info-text">{% trans "–≤—ã –≤–æ—à–ª–∏ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é. –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Å —ç—Ç–æ–π —Ñ—Ä–∞–∑–æ–π." %}</div>
                    </div>
                    <button type="submit" class="btn-logout" name="action" value="logout">{% trans "–≤—ã–π—Ç–∏" %}</button>
                    <button type="submit" class="btn-logout" name="action" value="change" style="margin-left: 10px;">–ø–æ–º–µ–Ω—è—Ç—å —Ñ—Ä–∞–∑—É –ø–∞—Ä–æ–ª—å</button>
                </form>
                {% endif %}
            </div>
            
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div class="upload-progress-container" id="uploadProgress">
                <div class="upload-progress-label">–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</div>
                <div class="upload-progress-bar">
                    <div class="upload-progress-fill" id="uploadProgressFill">0%</div>
                </div>
                <div class="upload-progress-text" id="uploadProgressText">–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ...</div>
            </div>
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ -->
            <div class="transcription-progress-container" id="transcriptionProgress">
                <div class="transcription-progress-header">
                    <div class="transcription-progress-title" id="transcriptionFileName">–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...</div>
                    <span class="transcription-status status-processing" id="transcriptionStatus">{% trans "–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è" %}</span>
                </div>
                <div class="transcription-progress-bar">
                    <div class="transcription-progress-fill" id="transcriptionProgressFill"></div>
                </div>
                <div class="transcription-progress-text" id="transcriptionProgressText">
                    <span class="spinner" style="display: inline-block; width: 16px; height: 16px; border-width: 3px;"></span>
                    –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è...
                </div>
            </div>
        </div>
        
        <div class="transcriptions-section">
            <h2>{% trans "–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏" %}</h2>
            <div id="transcriptionsList">
                {% if transcriptions %}
                    {% for transcription in transcriptions %}
                    <div class="transcription-item" data-id="{{ transcription.id }}">
                        <div class="transcription-header">
                            <span class="transcription-filename">{{ transcription.filename }}</span>
                            <span class="status-badge status-{{ transcription.status }}">
                                {% if transcription.status == 'pending' %}{% trans "–æ–∂–∏–¥–∞–µ—Ç" %}
                                {% elif transcription.status == 'processing' %}{% trans "–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è" %}
                                {% elif transcription.status == 'completed' %}{% trans "–∑–∞–≤–µ—Ä—à–µ–Ω–æ" %}
                                {% elif transcription.status == 'error' %}{% trans "–æ—à–∏–±–∫–∞" %}
                                {% endif %}
                            </span>
                        </div>
                        <div class="transcription-meta">
                            <span>üìÖ {{ transcription.uploaded_at|date:"d.m.Y H:i" }}</span>
                            <span>üåê IP: {{ transcription.ip_address }}</span>
                            {% if transcription.user_uuid %}
                            <span>üÜî UUID: {{ transcription.user_uuid }}</span>
                            {% endif %}
                            {% if transcription.signature %}
                            <span>‚úçÔ∏è {{ transcription.signature }}</span>
                            {% endif %}
                            <span>üì¶ {{ transcription.file_size|filesizeformat }}</span>
                        </div>
                        {% if transcription.status == 'completed' and transcription.transcribed_text %}
                        <div class="transcription-preview">
                            {{ transcription.transcribed_text|truncatewords:30 }}
                        </div>
                        {% elif transcription.status == 'processing' %}
                        <div class="transcription-preview">
                            <span class="spinner" style="display: inline-block; width: 16px; height: 16px; border-width: 3px;"></span>
                            –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...
                        </div>
                        {% elif transcription.status == 'error' %}
                        <div class="transcription-preview">
                            <p style="color: #000; font-weight: 900;">‚ùå {% trans "–æ—à–∏–±–∫–∞" %}: {{ transcription.error_message }}</p>
                        </div>
                        {% elif transcription.status == 'pending' %}
                        <div class="transcription-preview">
                            <p style="color: #666;">‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏...</p>
                        </div>
                        {% elif transcription.status == 'completed' and not transcription.transcribed_text %}
                        <div class="transcription-preview">
                            <p style="color: #ff6b6b; font-weight: 900;">‚ö†Ô∏è –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –Ω–æ —Ç–µ–∫—Å—Ç –ø—É—Å—Ç–æ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–æ–π –º–æ–¥–µ–ª—å—é.</p>
                        </div>
                        {% endif %}
                        {% if transcription.status == 'completed' and transcription.transcribed_text %}
                        <div style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
                            <a href="{% url 'transcription_detail' transcription.id %}" class="view-full">{% trans "—á–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Üí" %}</a>
                            <a href="{% url 'download_text' transcription.id %}" class="view-full" style="background: #4d9de0;">üìÑ {% trans "—Å–∫–∞—á–∞—Ç—å —Ç–µ–∫—Å—Ç" %}</a>
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <p>{% trans "–ø–æ–∫–∞ –Ω–µ—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π. –∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª!" %}</p>
                    </div>
                {% endif %}
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞ -->
                <div class="transcription-item" style="margin-top: 40px; background: #f5f5f5;">
                    <div style="font-size: 12px; line-height: 1.8; color: #666;">
                        <div style="margin-bottom: 15px;">
                            <strong style="cursor: pointer; color: #000; font-size: 14px;" onclick="toggleRequisites()">
                                –†–µ–∫–≤–∏–∑–∏—Ç—ã —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –ª–∏—Ü–∞ <span id="reqArrow">‚ñº</span>
                            </strong>
                            <div id="requisitesContent" style="display: none; margin-top: 10px; padding-left: 20px;">
                                <p><strong>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å</strong></p>
                                <ul style="list-style: none; padding: 0;">
                                    <li><strong>–û–ì–†–ù–ò–ü:</strong> 318774600019905</li>
                                    <li><strong>–ò–ù–ù:</strong> 773385920580</li>
                                    <li><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> 18.01.2018</li>
                                    <li><strong>–†–µ–≥–∏–æ–Ω:</strong> –≥–æ—Ä–æ–¥ –ú–æ—Å–∫–≤–∞</li>
                                    <li><strong>–û–ö–ü–û:</strong> 0124898807</li>
                                    <li><strong>–û–ö–ê–¢–û:</strong> 45283569000</li>
                                    <li><strong>–û–ö–¢–ú–û:</strong> 45368000000</li>
                                    <li><strong>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –ü–§–†:</strong> 1311981177</li>
                                    <li><strong>–ù–∞–ª–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º:</strong> –£–°–ù</li>
                                    <li><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> –ú–∏–∫—Ä–æ–ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 10px;">
                            <strong>–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã:</strong> –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã (Visa, MasterCard, –ú–ò–†), —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∏, –±–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥. –û–ø–ª–∞—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞.
                        </div>
                        
                        <div style="margin-bottom: 10px;">
                            <strong>–£—Å–ª–æ–≤–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞:</strong> –í–æ–∑–≤—Ä–∞—Ç –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –≤–æ–∑–º–æ–∂–µ–Ω –ø—Ä–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–±–æ—è—Ö, –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞—è–≤–ª–µ–Ω–Ω–æ–º—É –∫–∞—á–µ—Å—Ç–≤—É, –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –æ–ø–ª–∞—Ç—ã (–ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å–ª—É–≥–∏).
                        </div>
                        
                        <div style="margin-bottom: 10px;">
                            <strong>–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏:</strong> –ú—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π. –§–∞–π–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º. –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ –∏–ª–∏ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.
                        </div>
                        
                        <div>
                            <strong>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥:</strong> –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤: –ø–µ—Ä–≤—ã–µ 2 –∑–∞–≥—Ä—É–∑–∫–∏ - –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —Å 3-–π –∑–∞–≥—Ä—É–∑–∫–∏ - 12 —Ä—É–±–ª–µ–π –∑–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—é. –û–ø–ª–∞—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ—Å–ª–µ 2-–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP –∞–¥—Ä–µ—Å–∞ –∏–ª–∏ UUID –∑–∞ –º–µ—Å—è—Ü.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å–∫–µ —Å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–º —è–∑—ã–∫–∞ -->
        <div class="disk-info" id="diskInfo">
            <div class="disk-info-header" onclick="toggleDiskInfo()">
                <div class="disk-info-title">üíæ {% trans "—Å–≤–æ–±–æ–¥–Ω–æ –Ω–∞ –¥–∏—Å–∫–µ" %}</div>
                <button class="disk-info-toggle" onclick="event.stopPropagation(); toggleDiskInfo();">‚àí</button>
            </div>
            <div class="disk-info-content">
                <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞ -->
                <div class="disk-info-language-section">
                    <form action="{% url 'set_language' %}" method="post" style="margin: 0; display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                        {% csrf_token %}
                        <input name="next" type="hidden" value="{{ request.path }}" />
                        <label style="font-weight: 700; font-size: 12px; color: #fff; margin-right: 5px; white-space: nowrap;">üåê {% trans "—è–∑—ã–∫" %}:</label>
                        <select name="language" onchange="this.form.submit()" style="padding: 6px 10px; border: 2px solid #fff; font-weight: 700; font-size: 12px; background: #000; color: #fff; cursor: pointer; text-transform: uppercase; min-width: 100px; flex: 1;">
                            {% get_current_language as CURRENT_LANGUAGE %}
                            {% get_available_languages as LANGUAGES %}
                            {% for lang_code, lang_name in LANGUAGES %}
                                <option value="{{ lang_code }}" {% if lang_code == CURRENT_LANGUAGE %}selected{% endif %}>
                                    {% if lang_code == 'ru' %}üá∑üá∫ –†—É—Å—Å–∫–∏–π{% else %}üá¨üáß English{% endif %}
                                </option>
                            {% endfor %}
                        </select>
                    </form>
                </div>
                
                <div style="border-top: 2px solid rgba(255,255,255,0.3); margin: 10px 0; padding-top: 10px;"></div>
                
                <div class="disk-info-value">{{ disk_info.free_gb|floatformat:1 }} –ì–ë</div>
                <div class="disk-bar">
                    <div class="disk-bar-fill {% if disk_info.used_percent > 80 %}danger{% elif disk_info.used_percent > 60 %}warning{% endif %}" 
                         style="width: {{ disk_info.used_percent_int }}%"></div>
                </div>
                <div style="font-size: 10px; margin-top: 5px; opacity: 0.7;">
                    {% trans "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:" %} {{ disk_info.used_percent|floatformat:1 }}%
                </div>
                <button class="disk-clear-btn" onclick="showClearDiskModal()">{% trans "–æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –¥–∏—Å–∫" %}</button>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ–ø–ª–∞—Ç—ã -->
        <div class="payment-modal" id="paymentModal">
            <div class="payment-modal-content">
                <h3>üí≥ –û–ø–ª–∞—Ç–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏</h3>
                <p style="margin-bottom: 15px; font-weight: 700;">–°—Ç–æ–∏–º–æ—Å—Ç—å: <strong>12 —Ä—É–±–ª–µ–π</strong></p>
                <form id="paymentForm">
                    <div class="form-group">
                        <label for="cardNumber">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã:</label>
                        <input type="text" id="cardNumber" placeholder="0000 0000 0000 0000" maxlength="19" pattern="[0-9\s]+" required>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div class="form-group">
                            <label for="cardExpiry">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è:</label>
                            <input type="text" id="cardExpiry" placeholder="MM/YY" maxlength="5" pattern="[0-9]{2}/[0-9]{2}" required>
                        </div>
                        <div class="form-group">
                            <label for="cardCVC">CVC:</label>
                            <input type="text" id="cardCVC" placeholder="000" maxlength="3" pattern="[0-9]{3}" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="cardHolder">–ò–º—è –¥–µ—Ä–∂–∞—Ç–µ–ª—è –∫–∞—Ä—Ç—ã:</label>
                        <input type="text" id="cardHolder" placeholder="IVAN IVANOV" required>
                    </div>
                    <div class="payment-modal-buttons">
                        <button type="submit" class="payment-modal-btn confirm">–û–ø–ª–∞—Ç–∏—Ç—å 12 ‚ÇΩ</button>
                        <button type="button" class="payment-modal-btn cancel" onclick="closePaymentModal()">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–∞—Ä–æ–ª—è -->
        <div class="password-modal" id="passwordModal">
            <div class="password-modal-content">
                <h3>‚ö†Ô∏è {% trans "–æ—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–∞" %}</h3>
                <p style="margin-bottom: 15px; font-weight: 700;">{% trans "–≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:" %}</p>
                <input type="password" id="adminPassword" placeholder="{% trans "–ø–∞—Ä–æ–ª—å —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞" %}" autocomplete="off">
                <div class="password-modal-buttons">
                    <button class="password-modal-btn confirm" onclick="confirmClearDisk()">{% trans "–æ—á–∏—Å—Ç–∏—Ç—å" %}</button>
                    <button class="password-modal-btn cancel" onclick="closePasswordModal()">{% trans "–æ—Ç–º–µ–Ω–∞" %}</button>
                </div>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —è–∑—ã–∫–∞ -->
        <div class="payment-modal" id="languageModal">
            <div class="payment-modal-content">
                <h3>üåê {% trans "–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —è–∑—ã–∫–∞" %}</h3>
                <p style="margin-bottom: 15px; font-weight: 700;" id="languageModalText">
                    {% trans "–û–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–µ-—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –≤ –∞—É–¥–∏–æ —Ñ–∞–π–ª–µ. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏:" %}
                </p>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; cursor: pointer;">
                        <input type="radio" name="languageMode" value="auto" checked style="margin-right: 8px;">
                        <strong>{% trans "–ú—É–ª—å—Ç–∏—è–∑—ã–Ω–æ (–∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)" %}</strong> - {% trans "Whisper –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —è–∑—ã–∫" %}
                    </label>
                    <label style="display: block; margin-bottom: 10px; cursor: pointer;">
                        <input type="radio" name="languageMode" value="specific" style="margin-right: 8px;">
                        <strong>{% trans "–£–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —è–∑—ã–∫" %}</strong>
                    </label>
                    <select id="languageSelect" style="display: none; width: 100%; padding: 8px; margin-top: 10px; border: 1px solid #ddd; border-radius: 4px;">
                        <option value="ru">–†—É—Å—Å–∫–∏–π (Russian)</option>
                        <option value="en">English (–ê–Ω–≥–ª–∏–π—Å–∫–∏–π)</option>
                        <option value="es">Espa√±ol (–ò—Å–ø–∞–Ω—Å–∫–∏–π)</option>
                        <option value="fr">Fran√ßais (–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π)</option>
                        <option value="de">Deutsch (–ù–µ–º–µ—Ü–∫–∏–π)</option>
                        <option value="it">Italiano (–ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π)</option>
                        <option value="pt">Portugu√™s (–ü–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π)</option>
                        <option value="ja">Êó•Êú¨Ë™û (–Ø–ø–æ–Ω—Å–∫–∏–π)</option>
                        <option value="ko">ÌïúÍµ≠Ïñ¥ (–ö–æ—Ä–µ–π—Å–∫–∏–π)</option>
                        <option value="zh">‰∏≠Êñá (–ö–∏—Ç–∞–π—Å–∫–∏–π)</option>
                        <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© (–ê—Ä–∞–±—Å–∫–∏–π)</option>
                        <option value="tr">T√ºrk√ße (–¢—É—Ä–µ—Ü–∫–∏–π)</option>
                        <option value="pl">Polski (–ü–æ–ª—å—Å–∫–∏–π)</option>
                        <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ (–£–∫—Ä–∞–∏–Ω—Å–∫–∏–π)</option>
                        <option value="cs">ƒåe≈°tina (–ß–µ—à—Å–∫–∏–π)</option>
                        <option value="nl">Nederlands (–ì–æ–ª–ª–∞–Ω–¥—Å–∫–∏–π)</option>
                        <option value="sv">Svenska (–®–≤–µ–¥—Å–∫–∏–π)</option>
                        <option value="no">Norsk (–ù–æ—Ä–≤–µ–∂—Å–∫–∏–π)</option>
                        <option value="fi">Suomi (–§–∏–Ω—Å–∫–∏–π)</option>
                        <option value="el">ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨ (–ì—Ä–µ—á–µ—Å–∫–∏–π)</option>
                        <option value="he">◊¢◊ë◊®◊ô◊™ (–ò–≤—Ä–∏—Ç)</option>
                        <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (–•–∏–Ω–¥–∏)</option>
                        <option value="th">‡πÑ‡∏ó‡∏¢ (–¢–∞–π—Å–∫–∏–π)</option>
                        <option value="vi">Ti·∫øng Vi·ªát (–í—å–µ—Ç–Ω–∞–º—Å–∫–∏–π)</option>
                    </select>
                </div>
                <div class="payment-modal-buttons">
                    <button class="payment-modal-btn confirm" id="confirmLanguageBtn" onclick="confirmLanguage()">
                        {% trans "–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å" %}
                    </button>
                    <button class="payment-modal-btn cancel" onclick="closeLanguageModal()">
                        {% trans "–æ—Ç–º–µ–Ω–∞" %}
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ UUID
        function getOrCreateUUID() {
            let userUUID = localStorage.getItem('user_uuid');
            if (!userUUID) {
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π UUID
                userUUID = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    const r = Math.random() * 16 | 0;
                    const v = c == 'x' ? r : (r & 0x3 | 0x8);
                    return v.toString(16);
                });
                localStorage.setItem('user_uuid', userUUID);
            }
            return userUUID;
        }
        
        const userUUID = getOrCreateUUID();
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º UUID –≤ —Ö–µ–¥–µ—Ä–µ
        const userUUIDDisplay = document.getElementById('userUUIDDisplay');
        if (userUUIDDisplay) {
            userUUIDDisplay.textContent = userUUID;
        }
        
        const form = document.getElementById('uploadForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const btnSpinner = document.getElementById('btnSpinner');
        const message = document.getElementById('message');
        const uploadProgress = document.getElementById('uploadProgress');
        const uploadProgressFill = document.getElementById('uploadProgressFill');
        const uploadProgressText = document.getElementById('uploadProgressText');
        const transcriptionProgress = document.getElementById('transcriptionProgress');
        const transcriptionProgressFill = document.getElementById('transcriptionProgressFill');
        const transcriptionProgressText = document.getElementById('transcriptionProgressText');
        const transcriptionFileName = document.getElementById('transcriptionFileName');
        const transcriptionStatus = document.getElementById('transcriptionStatus');
        
        let currentTranscriptionId = null;
        let statusCheckInterval = null;
        let userBalance = null; // –ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function checkBalance() {
            fetch(`/check-balance/?user_uuid=${userUUID}`)
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        userBalance = data.balance;
                        updateUIForBalance(data.balance);
                    }
                })
                .catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –±–∞–ª–∞–Ω—Å–∞:', error);
                });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–∞–ª–∞–Ω—Å–∞
        function updateUIForBalance(balance) {
            const body = document.body;
            if (balance === 0) {
                body.classList.add('zero-balance');
            } else {
                body.classList.remove('zero-balance');
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        checkBalance();
        
        // –£–ª—É—á—à–µ–Ω–Ω—ã–π drag and drop
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('file');
        const fileList = document.getElementById('fileList');
        let selectedFiles = [];
        
        // –ö–ª–∏–∫ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º —Ñ–∞–π–ª–∞
        uploadArea.addEventListener('click', () => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º —Ñ–∞–π–ª–∞
            if (userBalance !== null && userBalance === 0) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É –æ–ø–ª–∞—Ç—ã
                showPaymentModal({
                    requires_payment: true,
                    message: '–£ –≤–∞—Å –∑–∞–∫–æ–Ω—á–∏–ª—Å—è –±–∞–ª–∞–Ω—Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–π. –î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞.'
                });
                return;
            }
            fileInput.click();
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤
        fileInput.addEventListener('change', (e) => {
            handleFiles(Array.from(e.target.files));
        });
        
        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                handleFiles(Array.from(e.dataTransfer.files));
            }
        });
        
        function handleFiles(files) {
            const validFiles = [];
            
            files.forEach(file => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø—É—Å—Ç–æ–π
                if (file.size === 0) {
                    showMessage(`—Ñ–∞–π–ª ${file.name} –ø—É—Å—Ç–æ–π`, 'error');
                } else {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –ª–∏ —Ñ–∞–π–ª —É–∂–µ (–ø–æ –∏–º–µ–Ω–∏ –∏ —Ä–∞–∑–º–µ—Ä—É)
                    const isDuplicate = selectedFiles.some(existingFile => 
                        existingFile.name === file.name && existingFile.size === file.size
                    );
                    if (!isDuplicate) {
                        validFiles.push(file);
                    }
                }
            });
            
            if (validFiles.length > 0) {
                selectedFiles = [...selectedFiles, ...validFiles];
                updateFileList();
            }
            
            // –û—á–∏—â–∞–µ–º input, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–µ–π –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—ã–±–æ—Ä–µ
            fileInput.value = '';
        }
        
        function updateFileList() {
            fileList.innerHTML = '';
            
            if (selectedFiles.length === 0) {
                uploadArea.querySelector('.upload-text').innerHTML = '<strong>{% trans "–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞" %}</strong><br>{% trans "–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞" %}';
                return;
            }
            
            uploadArea.querySelector('.upload-text').innerHTML = `<strong>–≤—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${selectedFiles.length}</strong>`;
            
            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <span class="file-item-name">${file.name}</span>
                    <span class="file-item-size">${formatBytes(file.size)}</span>
                    <button type="button" class="file-item-remove" onclick="removeFile(${index})">‚úï</button>
                `;
                fileList.appendChild(fileItem);
            });
        }
        
        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFileList();
        }
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (selectedFiles.length === 0) {
                showMessage('–ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã', 'error');
                return;
            }
            
            submitBtn.disabled = true;
            btnText.textContent = '–∑–∞–≥—Ä—É–∑–∫–∞...';
            btnSpinner.style.display = 'inline-block';
            message.classList.remove('active');
            uploadProgress.classList.add('active');
            transcriptionProgress.classList.remove('active');
            
            const formData = new FormData(form);
            
            // –î–æ–±–∞–≤–ª—è–µ–º UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            formData.append('user_uuid', userUUID);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
            selectedFiles.forEach(file => {
                formData.append('file', file);
            });
            
            const totalSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);
            const fileCount = selectedFiles.length;
            const fileNames = selectedFiles.map(f => f.name).join(', ');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            updateUploadProgress(0, `–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ ${fileCount} —Ñ–∞–π–ª${fileCount > 1 ? '–æ–≤' : ''} (${formatBytes(totalSize)})...`);
            
            try {
                const xhr = new XMLHttpRequest();
                let lastUpdateTime = Date.now();
                let lastLoaded = 0;
                let lastProgressTime = Date.now();
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
                const progressCheckInterval = setInterval(() => {
                    const now = Date.now();
                    // –ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è –±–æ–ª–µ–µ 2 –º–∏–Ω—É—Ç, —Å—á–∏—Ç–∞–µ–º —á—Ç–æ –∑–∞–≤–∏—Å–ª–æ
                    if (now - lastProgressTime > 120000) {
                        clearInterval(progressCheckInterval);
                        xhr.abort();
                        updateUploadProgress(0, '–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–ª–∞');
                        showMessage('–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–ª–∞ (–Ω–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –±–æ–ª–µ–µ 2 –º–∏–Ω—É—Ç). –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.', 'error');
                        resetForm();
                    }
                }, 10000); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
                
                xhr.upload.addEventListener('progress', (e) => {
                    lastProgressTime = Date.now(); // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                    
                    if (e.lengthComputable && e.total > 0) {
                        const percentComplete = Math.min((e.loaded / e.total) * 100, 99.9);
                        const now = Date.now();
                        const timeDiff = (now - lastUpdateTime) / 1000; // —Å–µ–∫—É–Ω–¥—ã
                        const loadedDiff = e.loaded - lastLoaded;
                        const speed = timeDiff > 0 ? loadedDiff / timeDiff : 0; // –±–∞–π—Ç/—Å–µ–∫
                        const remaining = e.total - e.loaded;
                        const eta = speed > 0 ? remaining / speed : 0; // —Å–µ–∫—É–Ω–¥—ã
                        
                        let speedText = '';
                        if (speed > 0) {
                            speedText = ` ‚Ä¢ ${formatBytes(speed)}/—Å–µ–∫`;
                            if (eta > 0 && eta < 3600) {
                                const minutes = Math.floor(eta / 60);
                                const seconds = Math.floor(eta % 60);
                                speedText += ` ‚Ä¢ –æ—Å—Ç–∞–ª–æ—Å—å ${minutes > 0 ? minutes + '–º ' : ''}${seconds}—Å`;
                            }
                        }
                        
                        updateUploadProgress(percentComplete, 
                            `–∑–∞–≥—Ä—É–∂–µ–Ω–æ ${formatBytes(e.loaded)} –∏–∑ ${formatBytes(e.total)}${speedText}`
                        );
                        
                        lastUpdateTime = now;
                        lastLoaded = e.loaded;
                    } else if (e.lengthComputable && e.total === 0) {
                        // –§–∞–π–ª —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π
                        updateUploadProgress(100, '–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
                    }
                });
                
                xhr.upload.addEventListener('loadstart', () => {
                    updateUploadProgress(0, '–Ω–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏...');
                });
                
                xhr.addEventListener('load', () => {
                    clearInterval(progressCheckInterval); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–≤–∏—Å–∞–Ω–∏—è
                    
                    if (xhr.status === 200) {
                        try {
                            const data = JSON.parse(xhr.responseText);
                            if (data.success) {
                                updateUploadProgress(100, `‚úì –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: ${data.count || fileCount}`);
                                showMessage(`—É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: ${data.count || fileCount}. –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—á–∞–ª–∞—Å—å.`, 'success');
                                
                                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤
                                if (data.files && data.files.length > 0) {
                                    uploadProgress.classList.remove('active');
                                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ñ–∞–π–ª–∞ (–∏–ª–∏ —Å—É–º–º–∞—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä)
                                    const totalSizeMB = data.files.reduce((sum, f) => sum + (f.size_mb || 0), 0);
                                    const firstFile = data.files[0];
                                    
                                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —è–∑—ã–∫–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
                                    if (firstFile.requires_language_confirmation && firstFile.detected_language) {
                                        showLanguageModal(firstFile.id, firstFile.detected_language);
                                    } else {
                                        startTranscriptionProgress(
                                            firstFile.id, 
                                            firstFile.filename, 
                                            totalSizeMB
                                        );
                                    }
                                }
                                
                                // –û—á–∏—â–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
                                selectedFiles = [];
                                updateFileList();
                                
                                // –ù–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–∑—É - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
                                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–≥–¥–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è
                            } else {
                                throw new Error(data.error || '{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ');
                            }
                        } catch (parseError) {
                            console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞:', parseError);
                            throw new Error('{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                        }
                    } else if (xhr.status === 402) {
                        // –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞
                        try {
                            const errorData = JSON.parse(xhr.responseText);
                            if (errorData.requires_payment) {
                                showPaymentModal(errorData);
                                resetForm();
                                return;
                            }
                        } catch (e) {
                            // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å, –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –æ–ø–ª–∞—Ç—ã
                            showPaymentModal({});
                        }
                        throw new Error('–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞');
                    } else {
                        let errorMsg = '{% trans "–æ—à–∏–±–∫–∞" %} —Å–µ—Ä–≤–µ—Ä–∞';
                        try {
                            const errorData = JSON.parse(xhr.responseText);
                            if (errorData.error) {
                                errorMsg = errorData.error;
                            }
                        } catch (e) {
                            errorMsg = `{% trans "–æ—à–∏–±–∫–∞" %} —Å–µ—Ä–≤–µ—Ä–∞ (–∫–æ–¥ ${xhr.status})`;
                        }
                        throw new Error(errorMsg);
                    }
                });
                
                xhr.addEventListener('error', () => {
                    clearInterval(progressCheckInterval);
                    throw new Error('{% trans "–æ—à–∏–±–∫–∞" %} —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.');
                });
                
                xhr.addEventListener('abort', () => {
                    clearInterval(progressCheckInterval);
                    updateUploadProgress(0, '–∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞');
                    resetForm();
                });
                
                xhr.addEventListener('timeout', () => {
                    clearInterval(progressCheckInterval);
                    updateUploadProgress(0, '—Ç–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏');
                    throw new Error('–ø—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (30 –º–∏–Ω—É—Ç). –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –∏–ª–∏ –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.');
                });
                
                xhr.open('POST', '/upload/');
                xhr.setRequestHeader('X-CSRFToken', document.querySelector('[name=csrfmiddlewaretoken]').value);
                xhr.timeout = 1800000; // 30 –º–∏–Ω—É—Ç —Ç–∞–π–º–∞—É—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (500 –ú–ë)
                xhr.send(formData);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                updateUploadProgress(0, '–æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
                showMessage('{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞: ' + error.message, 'error');
                resetForm();
            }
        });
        
        function updateUploadProgress(percent, text) {
            // –ü—Ä–æ—Å—Ç–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            const targetPercent = Math.max(0, Math.min(100, percent));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ä–∞–∑—É –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ (CSS transition —Å–¥–µ–ª–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—é)
            uploadProgressFill.style.width = targetPercent + '%';
            uploadProgressFill.textContent = Math.round(targetPercent) + '%';
            uploadProgressText.textContent = text || '';
        }
        
        function startTranscriptionProgress(transcriptionId, fileName, fileSizeMB = 0) {
            currentTranscriptionId = transcriptionId;
            transcriptionProgress.classList.add('active');
            transcriptionFileName.textContent = fileName;
            transcriptionStatus.textContent = '{% trans "–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è" %}';
            transcriptionStatus.className = 'transcription-status status-processing';
            
            // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
            // –ü—Ä–∏–º–µ—Ä–Ω–æ: 1 –ú–ë = 10-30 —Å–µ–∫—É–Ω–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
            const estimatedSeconds = fileSizeMB > 0 ? Math.max(10, Math.min(1800, fileSizeMB * 15)) : 60;
            let elapsedSeconds = 0;
            const startTime = Date.now();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏
            const progressInterval = setInterval(() => {
                elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
                const progress = Math.min(95, (elapsedSeconds / estimatedSeconds) * 100);
                transcriptionProgressFill.style.width = progress + '%';
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
                const remainingSeconds = Math.max(0, estimatedSeconds - elapsedSeconds);
                const minutes = Math.floor(remainingSeconds / 60);
                const seconds = remainingSeconds % 60;
                let timeText = '';
                if (minutes > 0) {
                    timeText = `~${minutes}–º ${seconds}—Å`;
                } else {
                    timeText = `~${seconds}—Å`;
                }
                
                let statusText = '–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è...';
                if (elapsedSeconds < 5) {
                    statusText = '–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ...';
                } else if (elapsedSeconds < estimatedSeconds * 0.3) {
                    statusText = `—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è... (–æ—Å—Ç–∞–ª–æ—Å—å ${timeText})`;
                } else if (elapsedSeconds < estimatedSeconds * 0.7) {
                    statusText = `–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ—á–∏... (–æ—Å—Ç–∞–ª–æ—Å—å ${timeText})`;
                } else {
                    statusText = `—Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è... (–æ—Å—Ç–∞–ª–æ—Å—å ${timeText})`;
                }
                
                transcriptionProgressText.innerHTML = `
                    <span class="spinner" style="display: inline-block; width: 16px; height: 16px; border-width: 3px;"></span>
                    ${statusText}
                `;
            }, 500);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
            statusCheckInterval = setInterval(async () => {
                try {
                    const response = await fetch(`/transcription/${transcriptionId}/status/`);
                    const data = await response.json();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —è–∑—ã–∫–∞
                    if (data.requires_language_confirmation && data.detected_language) {
                        clearInterval(statusCheckInterval);
                        clearInterval(progressInterval);
                        showLanguageModal(transcriptionId, data.detected_language);
                        return;
                    }
                    
                    if (data.status === 'completed') {
                        clearInterval(statusCheckInterval);
                        clearInterval(progressInterval);
                        transcriptionProgressFill.style.width = '100%';
                        transcriptionStatus.textContent = '{% trans "–∑–∞–≤–µ—Ä—à–µ–Ω–æ" %}';
                        transcriptionStatus.className = 'transcription-status status-completed';
                        transcriptionProgressText.innerHTML = '‚úÖ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!';
                        showMessage('—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                    } else if (data.status === 'error') {
                        clearInterval(statusCheckInterval);
                        clearInterval(progressInterval);
                        transcriptionStatus.textContent = '{% trans "–æ—à–∏–±–∫–∞" %}';
                        transcriptionStatus.className = 'transcription-status status-error';
                        transcriptionProgressText.textContent = '‚ùå ' + (data.error || '–ø—Ä–æ–∏–∑–æ—à–ª–∞ {% trans "–æ—à–∏–±–∫–∞" %}');
                        showMessage('{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è {% trans "–æ—à–∏–±–∫–∞" %}'), 'error');
                        resetForm();
                    } else if (data.status === 'processing') {
                        transcriptionProgressText.innerHTML = '<span class="spinner" style="display: inline-block; width: 16px; height: 16px; border-width: 3px;"></span> –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...';
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞:', error);
                }
            }, 3000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        }
        
        function resetForm() {
            submitBtn.disabled = false;
            btnText.textContent = '{% trans "–∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å" %}';
            btnSpinner.style.display = 'none';
            uploadProgress.classList.remove('active');
            // –û—á–∏—â–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏ —Å–±—Ä–æ—Å–µ —Ñ–æ—Ä–º—ã
            selectedFiles = [];
            updateFileList();
            fileInput.value = '';
            if (statusCheckInterval) {
                clearInterval(statusCheckInterval);
            }
        }
        
        function showMessage(text, type) {
            message.textContent = text;
            message.className = 'message ' + type + ' active';
            setTimeout(() => {
                message.classList.remove('active');
            }, 5000);
        }
        
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥–∏—Å–∫–µ
        function toggleDiskInfo() {
            const diskInfo = document.getElementById('diskInfo');
            const toggle = diskInfo.querySelector('.disk-info-toggle');
            diskInfo.classList.toggle('collapsed');
            toggle.textContent = diskInfo.classList.contains('collapsed') ? '+' : '‚àí';
        }
        
        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∏—Å–∫–∞
        function showClearDiskModal() {
            document.getElementById('passwordModal').classList.add('active');
            document.getElementById('adminPassword').focus();
        }
        
        function closePasswordModal() {
            document.getElementById('passwordModal').classList.remove('active');
            document.getElementById('adminPassword').value = '';
        }
        
        function confirmClearDisk() {
            const password = document.getElementById('adminPassword').value;
            if (!password) {
                alert('–≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å');
                return;
            }
            
            fetch('/clear-disk/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({password: password})
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('–¥–∏—Å–∫ –æ—á–∏—â–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                    closePasswordModal();
                    window.location.reload();
                } else {
                    alert('{% trans "–æ—à–∏–±–∫–∞" %}: ' + (data.error || '–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å'));
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–ø—Ä–æ–∏–∑–æ—à–ª–∞ {% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –¥–∏—Å–∫–∞');
            });
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
        document.getElementById('passwordModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closePasswordModal();
            }
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePasswordModal();
            }
        });
        
        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏—Ö—Å—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π –≤ —Å–ø–∏—Å–∫–µ
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º Map –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–µ–π
        const statusCheckIntervals = new Map();
        const processingItems = document.querySelectorAll('.transcription-item[data-id]');
        
        processingItems.forEach(item => {
            const status = item.querySelector('.status-badge');
            if (status && status.classList.contains('status-processing')) {
                const id = item.getAttribute('data-id');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–ø—É—â–µ–Ω –ª–∏ —É–∂–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
                if (statusCheckIntervals.has(id)) {
                    return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º, –µ—Å–ª–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª —É–∂–µ –∑–∞–ø—É—â–µ–Ω
                }
                
                const intervalId = setInterval(async () => {
                    try {
                        const response = await fetch(`/transcription/${id}/status/`);
                        const data = await response.json();
                        if (data.status === 'completed' || data.status === 'error') {
                            // –û—á–∏—â–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
                            clearInterval(intervalId);
                            statusCheckIntervals.delete(id);
                            window.location.reload();
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞:', error);
                        // –û—á–∏—â–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–∏ –æ—à–∏–±–∫–µ
                        clearInterval(intervalId);
                        statusCheckIntervals.delete(id);
                    }
                }, 5000);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
                statusCheckIntervals.set(id, intervalId);
            }
        });
        
        // –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –ø—Ä–∏ —É—Ö–æ–¥–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            statusCheckIntervals.forEach(intervalId => clearInterval(intervalId));
            statusCheckIntervals.clear();
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é
        const loginForm = document.getElementById('loginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData(loginForm);
                
                try {
                    const response = await fetch('/login/', {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                        }
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        showMessage('–≤—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else {
                        showMessage(data.error || '{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –≤—Ö–æ–¥–µ', 'error');
                    }
                } catch (error) {
                    showMessage('{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –≤—Ö–æ–¥–µ: ' + error.message, 'error');
                }
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Ö–æ–¥–∞
        const logoutForm = document.getElementById('logoutForm');
        if (logoutForm) {
            logoutForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                try {
                    const response = await fetch('/logout/', {
                        method: 'POST',
                        headers: {
                            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: 'csrfmiddlewaretoken=' + document.querySelector('[name=csrfmiddlewaretoken]').value
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        showMessage('–≤—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else {
                        showMessage(data.error || '{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ', 'error');
                    }
                } catch (error) {
                    showMessage('{% trans "–æ—à–∏–±–∫–∞" %} –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ: ' + error.message, 'error');
                }
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è/—Å–∫—Ä—ã—Ç–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
        function toggleRequisites() {
            const content = document.getElementById('requisitesContent');
            const arrow = document.getElementById('reqArrow');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                arrow.textContent = '‚ñ≤';
            } else {
                content.style.display = 'none';
                arrow.textContent = '‚ñº';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–æ–π –æ–ø–ª–∞—Ç—ã
        function showPaymentModal(data) {
            document.getElementById('paymentModal').classList.add('active');
            document.getElementById('cardNumber').focus();
        }
        
        function closePaymentModal() {
            document.getElementById('paymentModal').classList.remove('active');
            document.getElementById('paymentForm').reset();
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –æ–ø–ª–∞—Ç—ã
        const paymentForm = document.getElementById('paymentForm');
        if (paymentForm) {
            paymentForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
                const cardExpiry = document.getElementById('cardExpiry').value;
                const cardCVC = document.getElementById('cardCVC').value;
                const cardHolder = document.getElementById('cardHolder').value;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è (–ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–∞—è, –ø–æ—Ç–æ–º –±—É–¥–µ—Ç —á–µ—Ä–µ–∑ API)
                if (cardNumber.length < 16 || cardCVC.length < 3 || !cardExpiry.match(/^\d{2}\/\d{2}$/)) {
                    showMessage('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'error');
                    return;
                }
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã
                // –ï—Å–ª–∏ –≤—Å–µ –ø–æ–ª—è - –Ω—É–ª–∏, —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ç–µ—Å—Ç–æ–≤—É—é –æ–ø–ª–∞—Ç—É
                try {
                    const response = await fetch('/payment/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                        },
                        body: JSON.stringify({
                            user_uuid: userUUID,
                            payment_data: {
                                card_number: cardNumber,
                                card_expiry: cardExpiry,
                                card_cvc: cardCVC,
                                card_holder: cardHolder,
                                amount: 12.00
                            }
                        })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        showMessage(data.message || '–û–ø–ª–∞—Ç–∞ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞! –í–∞–º –¥–æ–±–∞–≤–ª–µ–Ω–æ 3 —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã.', 'success');
                        closePaymentModal();
                        // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
                        if (data.balance !== undefined) {
                            userBalance = data.balance;
                            updateUIForBalance(data.balance);
                        } else {
                            // –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
                            checkBalance();
                        }
                        // –ù–ï –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–∑—É - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
                        // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
                    } else {
                        showMessage('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–ø–ª–∞—Ç—ã: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                    }
                } catch (error) {
                    showMessage('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–ø–ª–∞—Ç—ã: ' + error.message, 'error');
                }
            });
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã
        const cardNumberInput = document.getElementById('cardNumber');
        if (cardNumberInput) {
            cardNumberInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\s/g, '');
                if (value.length > 16) value = value.slice(0, 16);
                value = value.replace(/(.{4})/g, '$1 ').trim();
                e.target.value = value;
            });
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
        const cardExpiryInput = document.getElementById('cardExpiry');
        if (cardExpiryInput) {
            cardExpiryInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.slice(0, 2) + '/' + value.slice(2, 4);
                }
                e.target.value = value;
            });
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –æ–ø–ª–∞—Ç—ã –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
        document.getElementById('paymentModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closePaymentModal();
            }
        });
        
        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —è–∑—ã–∫–∞
        let currentLanguageTranscriptionId = null;
        
        function showLanguageModal(transcriptionId, detectedLanguage) {
            currentLanguageTranscriptionId = transcriptionId;
            const languageNames = {
                'en': '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π',
                'es': '–ò—Å–ø–∞–Ω—Å–∫–∏–π',
                'fr': '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π',
                'de': '–ù–µ–º–µ—Ü–∫–∏–π',
                'it': '–ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–π',
                'pt': '–ü–æ—Ä—Ç—É–≥–∞–ª—å—Å–∫–∏–π',
                'ja': '–Ø–ø–æ–Ω—Å–∫–∏–π',
                'ko': '–ö–æ—Ä–µ–π—Å–∫–∏–π',
                'zh': '–ö–∏—Ç–∞–π—Å–∫–∏–π',
                'ar': '–ê—Ä–∞–±—Å–∫–∏–π',
                'tr': '–¢—É—Ä–µ—Ü–∫–∏–π',
                'pl': '–ü–æ–ª—å—Å–∫–∏–π',
                'uk': '–£–∫—Ä–∞–∏–Ω—Å–∫–∏–π',
                'cs': '–ß–µ—à—Å–∫–∏–π',
                'nl': '–ì–æ–ª–ª–∞–Ω–¥—Å–∫–∏–π',
                'sv': '–®–≤–µ–¥—Å–∫–∏–π',
                'no': '–ù–æ—Ä–≤–µ–∂—Å–∫–∏–π',
                'fi': '–§–∏–Ω—Å–∫–∏–π'
            };
            const languageName = languageNames[detectedLanguage] || detectedLanguage.toUpperCase();
            document.getElementById('languageModalText').textContent = 
                `–û–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–µ-—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –≤ –∞—É–¥–∏–æ —Ñ–∞–π–ª–µ: ${languageName} (${detectedLanguage}). –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏:`;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –≤ —Å–µ–ª–µ–∫—Ç–µ, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ
            const languageSelect = document.getElementById('languageSelect');
            if (languageSelect.querySelector(`option[value="${detectedLanguage}"]`)) {
                languageSelect.value = detectedLanguage;
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ —è–∑—ã–∫–∞
            const languageModeRadios = document.querySelectorAll('input[name="languageMode"]');
            languageModeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'specific') {
                        languageSelect.style.display = 'block';
                    } else {
                        languageSelect.style.display = 'none';
                    }
                });
            });
            
            document.getElementById('languageModal').classList.add('active');
        }
        
        function closeLanguageModal() {
            document.getElementById('languageModal').classList.remove('active');
            currentLanguageTranscriptionId = null;
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
            document.querySelector('input[name="languageMode"][value="auto"]').checked = true;
            document.getElementById('languageSelect').style.display = 'none';
        }
        
        function confirmLanguage() {
            if (!currentLanguageTranscriptionId) {
                return;
            }
            
            const languageMode = document.querySelector('input[name="languageMode"]:checked').value;
            const selectedLanguage = languageMode === 'specific' ? document.getElementById('languageSelect').value : null;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const confirmBtn = document.getElementById('confirmLanguageBtn');
            const originalText = confirmBtn.textContent;
            confirmBtn.disabled = true;
            confirmBtn.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞...';
            
            fetch(`/transcription/${currentLanguageTranscriptionId}/confirm-language/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({
                    language_mode: languageMode,
                    selected_language: selectedLanguage
                })
            })
            .then(response => response.json())
            .then(data => {
                confirmBtn.disabled = false;
                confirmBtn.textContent = originalText;
                
                if (data.success) {
                    showMessage('–Ø–∑—ã–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω. –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è.', 'success');
                    closeLanguageModal();
                    
                    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
                    if (statusCheckInterval) {
                        clearInterval(statusCheckInterval);
                        statusCheckInterval = null;
                    }
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–ª–∏ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
                    let fileName = transcriptionFileName ? transcriptionFileName.textContent : '–§–∞–π–ª';
                    if (!fileName || fileName === '{% trans "–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è" %}') {
                        // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
                        fetch(`/transcription/${currentLanguageTranscriptionId}/status/`)
                            .then(r => r.json())
                            .then(statusData => {
                                // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–Ω–æ–≤–æ
                                startTranscriptionProgress(currentLanguageTranscriptionId, fileName, 0);
                            })
                            .catch(() => {
                                // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                                startTranscriptionProgress(currentLanguageTranscriptionId, fileName, 0);
                            });
                    } else {
                        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–Ω–æ–≤–æ
                        startTranscriptionProgress(currentLanguageTranscriptionId, fileName, 0);
                    }
                } else {
                    showMessage('–û—à–∏–±–∫–∞: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                }
            })
            .catch(error => {
                confirmBtn.disabled = false;
                confirmBtn.textContent = originalText;
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —è–∑—ã–∫–∞:', error);
                showMessage('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —è–∑—ã–∫–∞: ' + error.message, 'error');
            });
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —è–∑—ã–∫–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
        document.getElementById('languageModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closeLanguageModal();
            }
        });
    </script>
    
</body>
</html>

