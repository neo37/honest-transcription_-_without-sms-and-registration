<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ß–µ—Å—Ç–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≤–∞—à–∏—Ö –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Arial Black', Arial, sans-serif;
            background: #fff;
            color: #000;
            line-height: 1.6;
            padding: 20px;
        }
        
        .main-wrapper {
            display: flex;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .container {
            flex: 1;
            background: #fff;
            border: 4px solid #000;
            box-shadow: 8px 8px 0 #000;
        }
        
        .sidebar {
            width: 300px;
            background: #fff;
            border: 4px solid #000;
            box-shadow: 8px 8px 0 #000;
            padding: 20px;
            position: sticky;
            top: 20px;
            height: fit-content;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }
        
        .sidebar-title {
            font-size: 18px;
            font-weight: 900;
            text-transform: uppercase;
            margin-bottom: 20px;
            border-bottom: 3px solid #000;
            padding-bottom: 10px;
        }
        
        .sidebar-group {
            margin-bottom: 20px;
        }
        
        .sidebar-group label {
            display: block;
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 8px;
            color: #000;
        }
        
        .sidebar-group input,
        .sidebar-group select {
            width: 100%;
            padding: 10px;
            border: 3px solid #000;
            font-weight: 700;
            font-size: 14px;
            background: #fff;
        }
        
        .sidebar-group .info-text {
            font-size: 11px;
            margin-top: 5px;
            opacity: 0.8;
            font-weight: 600;
        }
        
        .sidebar-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }
        
        .sidebar-checkbox input[type="checkbox"] {
            width: auto;
            height: 20px;
            cursor: pointer;
        }
        
        .burger-menu {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: #ff6b6b;
            border: 4px solid #000;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 4px 4px 0 #000;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 900;
        }
        
        .burger-menu:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
        }
        
        .sidebar-overlay.active {
            display: block;
        }
        
        @media (max-width: 1024px) {
            .main-wrapper {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                position: static;
                max-height: none;
            }
        }
        
        @media (max-width: 768px) {
            .burger-menu {
                display: flex;
            }
            
            .sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: 280px;
                height: 100vh;
                z-index: 1002;
                transition: left 0.3s ease;
                max-height: 100vh;
                overflow-y: auto;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            body {
                padding: 80px 10px 10px 10px;
            }
        }
        
        .header {
            background: #ff6b6b;
            color: #000;
            padding: 10px 30px;
            text-align: center;
            border-bottom: 4px solid #000;
            position: relative;
        }
        
        .header h1 {
            font-size: clamp(12.6px, 2.2vw, 22.68px);
            font-weight: 900;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: -1px;
            animation: textDance 2s ease-in-out infinite;
            text-align: left;
            line-height: 1.2;
        }
        
        .header .subtitle {
            font-size: clamp(11px, 1.5vw, 14px);
            font-weight: 600;
            opacity: 0.9;
            text-transform: lowercase;
            animation: textPulse 3s ease-in-out infinite;
        }
        
        @keyframes textDance {
            0%, 100% {
                transform: translateY(0) rotate(0deg) scale(1);
                text-shadow: 2px 2px 0 #000, 4px 4px 0 #ffd93d;
            }
            25% {
                transform: translateY(-3px) rotate(-1deg) scale(1.02);
                text-shadow: 3px 3px 0 #000, 6px 6px 0 #6bcf7f, 8px 8px 0 #ffd93d;
            }
            50% {
                transform: translateY(0) rotate(0deg) scale(1);
                text-shadow: 2px 2px 0 #000, 4px 4px 0 #ffd93d;
            }
            75% {
                transform: translateY(-3px) rotate(1deg) scale(1.02);
                text-shadow: 3px 3px 0 #000, 6px 6px 0 #4d9de0, 8px 8px 0 #ffd93d;
            }
        }
        
        @keyframes textPulse {
            0%, 100% {
                opacity: 0.8;
                transform: translateY(0);
            }
            50% {
                opacity: 1;
                transform: translateY(-2px);
            }
        }
        
        .upload-section {
            padding: 30px;
            border-bottom: 4px solid #000;
        }
        
        /* –°–µ–∫—Ü–∏—è –≤—Ö–æ–¥–∞ */
        .login-section {
            background: #ffd93d;
            padding: 20px;
            border: 4px solid #000;
            margin-bottom: 20px;
            box-shadow: 4px 4px 0 #000;
        }
        
        .login-section.logged-in {
            background: #6bcf7f;
        }
        
        .login-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .login-title {
            font-weight: 900;
            color: #000;
            font-size: clamp(16px, 3vw, 20px);
            text-transform: uppercase;
        }
        
        .login-status {
            padding: 8px 16px;
            border: 3px solid #000;
            font-size: 14px;
            font-weight: 900;
            background: #000;
            color: #fff;
        }
        
        .login-form {
            display: flex;
            gap: 10px;
            align-items: flex-end;
            flex-wrap: wrap;
        }
        
        .login-form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .login-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 900;
            color: #000;
            font-size: 14px;
            text-transform: uppercase;
        }
        
        .login-form-group input {
            width: 100%;
            padding: 12px;
            border: 3px solid #000;
            border-radius: 0;
            font-size: 16px;
            font-weight: 700;
            background: #fff;
            box-shadow: 3px 3px 0 #000;
        }
        
        .login-form-group input:focus {
            outline: none;
            box-shadow: 5px 5px 0 #000;
            transform: translate(-2px, -2px);
        }
        
        .btn-login, .btn-logout {
            padding: 12px 24px;
            border: 3px solid #000;
            font-size: 16px;
            font-weight: 900;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.1s;
            box-shadow: 4px 4px 0 #000;
        }
        
        .btn-login {
            background: #6bcf7f;
            color: #000;
        }
        
        .btn-logout {
            background: #ff6b6b;
            color: #000;
        }
        
        .btn-login:hover, .btn-logout:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .btn-login:active, .btn-logout:active {
            transform: translate(4px, 4px);
            box-shadow: 0 0 0 #000;
        }
        
        .info-text {
            font-size: 12px;
            color: #000;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .upload-form-wrapper {
            margin-bottom: 30px;
        }
        
        .upload-form {
            background: #fff;
            padding: 30px;
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
        }
        
        .upload-area {
            border: 4px dashed #000;
            padding: 60px 20px;
            text-align: center;
            background: #f5f5f5;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 20px;
            position: relative;
        }
        
        .upload-area:hover {
            background: #ffd93d;
            transform: translate(-2px, -2px);
            box-shadow: 4px 4px 0 #000;
        }
        
        .upload-area.dragover {
            background: #6bcf7f;
            border-color: #000;
            transform: scale(1.02);
        }
        
        .upload-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        
        .upload-text {
            font-size: 18px;
            font-weight: 700;
            color: #000;
            line-height: 1.6;
        }
        
        .file-list {
            margin-top: 20px;
            text-align: left;
        }
        
        .file-item {
            background: #fff;
            border: 3px solid #000;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
        }
        
        .file-item-name {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .file-item-size {
            margin-left: 15px;
            color: #666;
            font-size: 14px;
        }
        
        .file-item-remove {
            background: #ff6b6b;
            color: #000;
            border: 2px solid #000;
            padding: 5px 10px;
            cursor: pointer;
            font-weight: 900;
            margin-left: 10px;
        }
        
        .file-item-remove:hover {
            transform: scale(1.1);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 900;
            color: #000;
            font-size: 16px;
            text-transform: uppercase;
        }
        
        .form-group input[type="file"],
        .form-group input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 3px solid #000;
            border-radius: 0;
            font-size: 16px;
            font-weight: 700;
            background: #fff;
            box-shadow: 3px 3px 0 #000;
            transition: all 0.1s;
        }
        
        .form-group input[type="file"]:focus,
        .form-group input[type="text"]:focus {
            outline: none;
            box-shadow: 5px 5px 0 #000;
            transform: translate(-2px, -2px);
        }
        
        /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã */
        .upload-progress-container {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #fff;
            border: 3px solid #000;
            box-shadow: 4px 4px 0 #000;
        }
        
        .upload-progress-container.active {
            display: block;
        }
        
        .upload-progress-label {
            font-weight: 900;
            margin-bottom: 15px;
            color: #000;
            font-size: 18px;
            text-transform: uppercase;
        }
        
        .upload-progress-bar {
            width: 100%;
            height: 40px;
            background: #fff;
            border: 3px solid #000;
            overflow: hidden;
            position: relative;
            box-shadow: 3px 3px 0 #000;
        }
        
        .upload-progress-fill {
            height: 100%;
            background: #6bcf7f;
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: 900;
            font-size: 16px;
            border-right: 3px solid #000;
        }
        
        .upload-progress-text {
            margin-top: 15px;
            text-align: center;
            color: #000;
            font-size: 14px;
            font-weight: 700;
        }
        
        .transcription-progress-container {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #ffd93d;
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
        }
        
        .transcription-progress-container.active {
            display: block;
        }
        
        .transcription-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .transcription-progress-title {
            font-weight: 900;
            color: #000;
            font-size: clamp(16px, 3vw, 20px);
            text-transform: uppercase;
        }
        
        .transcription-status {
            padding: 8px 16px;
            border: 3px solid #000;
            font-size: 14px;
            font-weight: 900;
        }
        
        .status-pending {
            background: #ffd93d;
            color: #000;
        }
        
        .status-processing {
            background: #4d9de0;
            color: #000;
            animation: pulse 1s infinite;
        }
        
        .status-completed {
            background: #6bcf7f;
            color: #000;
        }
        
        .status-error {
            background: #ff6b6b;
            color: #000;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .transcription-progress-bar {
            width: 100%;
            height: 35px;
            background: #fff;
            border: 3px solid #000;
            overflow: hidden;
            position: relative;
            margin-bottom: 10px;
            box-shadow: 3px 3px 0 #000;
        }
        
        .transcription-progress-fill {
            height: 100%;
            background: #6bcf7f;
            width: 0%;
            transition: width 0.5s ease;
            border-right: 3px solid #000;
        }
        
        .transcription-progress-text {
            text-align: center;
            color: #000;
            font-size: 14px;
            font-weight: 700;
            margin-top: 10px;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 4px solid #000;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .btn {
            background: #6bcf7f;
            color: #000;
            border: 4px solid #000;
            padding: 18px 40px;
            font-size: 18px;
            font-weight: 900;
            border-radius: 0;
            cursor: pointer;
            transition: all 0.1s;
            width: 100%;
            text-transform: uppercase;
            box-shadow: 6px 6px 0 #000;
        }
        
        .btn:hover:not(:disabled) {
            transform: translate(4px, 4px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .btn:active:not(:disabled) {
            transform: translate(6px, 6px);
            box-shadow: 0 0 0 #000;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .transcriptions-section {
            padding: 30px;
        }
        
        .transcriptions-section h2 {
            margin-bottom: 25px;
            color: #000;
            font-size: clamp(24px, 4vw, 32px);
            font-weight: 900;
            text-transform: uppercase;
            border-bottom: 4px solid #000;
            padding-bottom: 10px;
            animation: textDance 2s ease-in-out infinite;
        }
        
        .transcription-item {
            background: #fff;
            padding: 25px;
            margin-bottom: 20px;
            border: 4px solid #000;
            box-shadow: 6px 6px 0 #000;
            transition: all 0.1s;
        }
        
        .transcription-item:hover {
            transform: translate(4px, 4px);
            box-shadow: 2px 2px 0 #000;
        }
        
        .transcription-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .transcription-filename {
            font-weight: 900;
            color: #000;
            font-size: clamp(16px, 3vw, 20px);
            text-transform: uppercase;
        }
        
        .transcription-date {
            color: #000;
            font-size: 14px;
            font-weight: 700;
        }
        
        .transcription-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #000;
            font-weight: 700;
            flex-wrap: wrap;
        }
        
        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border: 3px solid #000;
            font-size: 12px;
            font-weight: 900;
            text-transform: uppercase;
        }
        
        .transcription-preview {
            margin-top: 15px;
            padding: 20px;
            background: #f5f5f5;
            border: 3px solid #000;
            max-height: 150px;
            overflow: hidden;
            font-weight: 600;
            line-height: 1.8;
        }
        
        .view-full {
            display: inline-block;
            margin-top: 15px;
            color: #000;
            text-decoration: none;
            font-weight: 900;
            font-size: 16px;
            text-transform: uppercase;
            border-bottom: 3px solid #000;
            padding-bottom: 2px;
        }
        
        .view-full:hover {
            background: #ffd93d;
            padding: 5px 10px;
            border: 3px solid #000;
            box-shadow: 3px 3px 0 #000;
        }
        
        .message {
            padding: 20px;
            margin-bottom: 20px;
            border: 4px solid #000;
            display: none;
            font-weight: 700;
            box-shadow: 4px 4px 0 #000;
        }
        
        .message.success {
            background: #6bcf7f;
            color: #000;
        }
        
        .message.error {
            background: #ff6b6b;
            color: #000;
        }
        
        .message.active {
            display: block;
        }
        
        .empty-state {
            text-align: center;
            color: #000;
            padding: 60px 20px;
            font-size: 18px;
            font-weight: 700;
            border: 4px solid #000;
            background: #f5f5f5;
            box-shadow: 4px 4px 0 #000;
        }
        
        .disk-info {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.85);
            color: #fff;
            padding: 15px 20px;
            border: 4px solid #fff;
            font-weight: 900;
            font-size: 14px;
            z-index: 100;
            box-shadow: 4px 4px 0 #fff;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            min-width: 250px;
        }
        
        .disk-info.collapsed {
            padding: 10px 15px;
        }
        
        .disk-info.collapsed .disk-info-content {
            display: none;
        }
        
        .disk-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            margin-bottom: 10px;
        }
        
        .disk-info-title {
            text-transform: uppercase;
            font-size: 12px;
            flex: 1;
        }
        
        .disk-info-toggle {
            background: #fff;
            color: #000;
            border: 2px solid #000;
            padding: 4px 8px;
            font-weight: 900;
            font-size: 12px;
            cursor: pointer;
            margin-left: 10px;
        }
        
        .disk-info-toggle:hover {
            background: #ffd93d;
        }
        
        .disk-info-content {
            transition: opacity 0.3s;
        }
        
        .disk-info-value {
            font-size: 18px;
            color: #6bcf7f;
            margin-bottom: 8px;
        }
        
        .disk-bar {
            width: 100%;
            height: 20px;
            background: #333;
            border: 2px solid #fff;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .disk-bar-fill {
            height: 100%;
            background: #6bcf7f;
            transition: width 0.3s;
        }
        
        .disk-bar-fill.warning {
            background: #ffd93d;
        }
        
        .disk-bar-fill.danger {
            background: #ff6b6b;
        }
        
        .disk-clear-btn {
            margin-top: 10px;
            background: #ff6b6b;
            color: #000;
            border: 3px solid #fff;
            padding: 8px 15px;
            font-weight: 900;
            font-size: 12px;
            cursor: pointer;
            text-transform: uppercase;
            width: 100%;
            box-shadow: 3px 3px 0 #fff;
        }
        
        .disk-clear-btn:hover {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0 #fff;
        }
        
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .password-modal.active {
            display: flex;
        }
        
        .password-modal-content {
            background: #fff;
            padding: 30px;
            border: 4px solid #000;
            box-shadow: 8px 8px 0 #000;
            max-width: 400px;
            width: 90%;
        }
        
        .password-modal-content h3 {
            margin: 0 0 20px 0;
            font-weight: 900;
            text-transform: uppercase;
        }
        
        .password-modal-content input {
            width: 100%;
            padding: 12px;
            border: 3px solid #000;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .password-modal-buttons {
            display: flex;
            gap: 10px;
        }
        
        .password-modal-btn {
            flex: 1;
            padding: 12px;
            border: 3px solid #000;
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
        }
        
        .password-modal-btn.confirm {
            background: #ff6b6b;
        }
        
        .password-modal-btn.cancel {
            background: #6bcf7f;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 80px 10px 10px 10px;
            }
            
            .container {
                border-width: 3px;
                box-shadow: 4px 4px 0 #000;
            }
            
            .header {
                padding: 25px 20px;
            }
            
            .upload-section,
            .transcriptions-section {
                padding: 20px;
            }
            
            .form-group input,
            .btn {
                font-size: 16px;
            }
            
            .transcription-item {
                padding: 15px;
            }
        }
    </style>
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=105456934', 'ym');

        ym(105456934, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/105456934" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
</head>
<body>
    <div class="burger-menu" id="burgerMenu" onclick="toggleSidebar()">‚ò∞</div>
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    
    <div class="main-wrapper">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-title">‚öôÔ∏è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            
            <div class="sidebar-group">
                <label class="sidebar-checkbox">
                    <input type="checkbox" id="extract_screenshots" name="extract_screenshots">
                    <span>–≤—ã–Ω—É—Ç—å —Å–∫—Ä–∏–Ω—ã –∏–∑ –≤–∏–¥–µ–æ (1 —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É)</span>
                </label>
            </div>
            
            <div class="sidebar-group">
                <label for="whisper_model">–º–æ–¥–µ–ª—å –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏:</label>
                <select id="whisper_model" name="whisper_model">
                    <option value="base" selected>Base (–±–∞–ª–∞–Ω—Å, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</option>
                    <option value="tiny">Tiny (–±—ã—Å—Ç—Ä–∞—è, –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)</option>
                    <option value="small">Small (—Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)</option>
                    <option value="medium">Medium (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)</option>
                    <option value="large-v2">Large-v2 (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –º–µ–¥–ª–µ–Ω–Ω–æ)</option>
                    <option value="large-v3">Large-v3 (–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –º–µ–¥–ª–µ–Ω–Ω–æ)</option>
                </select>
                <div class="info-text">–≤—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å: –±—ã—Å—Ç—Ä–∞—è = –º–µ–Ω—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å, –º–µ–¥–ª–µ–Ω–Ω–∞—è = –±–æ–ª—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å</div>
            </div>
            
            <div class="sidebar-group">
                <label for="signature">–ø–æ–¥–ø–∏—Å—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
                <input type="text" id="signature" name="signature" placeholder="–≤–≤–µ–¥–∏—Ç–µ –ø–æ–¥–ø–∏—Å—å...">
            </div>
            
            <div class="sidebar-group">
                <label for="password_phrase">—Ñ—Ä–∞–∑–∞-–ø–∞—Ä–æ–ª—å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
                <input type="text" id="password_phrase" name="password_phrase" placeholder="–≤–≤–µ–¥–∏—Ç–µ —Ñ—Ä–∞–∑—É-–ø–∞—Ä–æ–ª—å –¥–ª—è –∑–∞—â–∏—Ç—ã..." value="{% if is_logged_in %}{{ active_phrase }}{% endif %}">
                <div class="info-text">–µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å —Ñ—Ä–∞–∑—É-–ø–∞—Ä–æ–ª—å, —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ —Ç–µ–º, –∫—Ç–æ –≤–æ–π–¥–µ—Ç –ø–æ —ç—Ç–æ–π —Ñ—Ä–∞–∑–µ</div>
            </div>
        </div>
        
        <div class="container">
        <div class="header">
            <h1>—á–µ—Å—Ç–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è<br>–ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤</h1>
            <div class="subtitle">–ø–µ—Ä–µ–≤–µ–¥—ë–º –≤–∞—à–µ –∞—É–¥–∏–æ –∏–ª–∏ –≤–∫—Å –≤–∏–¥–µ–æ –≤ —Ç–µ–∫—Å—Ç. —á–µ—Å—Ç–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥, –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–∏—Å</div>
        </div>
        
        <div class="upload-section">
            <!-- –£–ª—É—á—à–µ–Ω–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ -->
            <div class="upload-form-wrapper">
                <div class="message" id="message"></div>
                <form class="upload-form" id="uploadForm" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-text">
                            <strong>–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</strong><br>
                            –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞
                        </div>
                        <input type="file" id="file" name="file" accept="audio/*,video/*" multiple required style="display: none;">
                        <div class="file-list" id="fileList"></div>
                    </div>
                    <button type="submit" class="btn" id="submitBtn">
                        <span id="btnText">–∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å</span>
                        <span id="btnSpinner" style="display: none;" class="spinner"></span>
                    </button>
                </form>
            </div>
            
            <!-- –°–µ–∫—Ü–∏—è –≤—Ö–æ–¥–∞ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é -->
            <div class="login-section {% if is_logged_in %}logged-in{% endif %}" id="loginSection" style="margin-top: 30px;">
                <div class="login-header">
                    <div class="login-title">üîê –≤—Ö–æ–¥ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é</div>
                    {% if is_logged_in %}
                    <span class="login-status">–≤—Ö–æ–¥: {{ active_phrase }}</span>
                    {% endif %}
                </div>
                {% if not is_logged_in %}
                <form class="login-form" id="loginForm">
                    {% csrf_token %}
                    <div class="login-form-group">
                        <label for="login_phrase">—Ñ—Ä–∞–∑–∞-–ø–∞—Ä–æ–ª—å:</label>
                        <input type="text" id="login_phrase" name="password_phrase" placeholder="–≤–≤–µ–¥–∏—Ç–µ —Ñ—Ä–∞–∑—É..." required>
                    </div>
                    <button type="submit" class="btn-login">–≤–æ–π—Ç–∏</button>
                </form>
                <div class="info-text">–≤–æ–π–¥–∏—Ç–µ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å —ç—Ç–æ–π —Ñ—Ä–∞–∑–æ–π</div>
                {% else %}
                <form class="login-form" id="logoutForm">
                    {% csrf_token %}
                    <div class="login-form-group" style="flex: 1;">
                        <div class="info-text">–≤—ã –≤–æ—à–ª–∏ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é. –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Å —ç—Ç–æ–π —Ñ—Ä–∞–∑–æ–π.</div>
                    </div>
                    <button type="submit" class="btn-logout" name="action" value="logout">–≤—ã–π—Ç–∏</button>
                    <button type="submit" class="btn-logout" name="action" value="change" style="margin-left: 10px;">–ø–æ–º–µ–Ω—è—Ç—å —Ñ—Ä–∞–∑—É –ø–∞—Ä–æ–ª—å</button>
                </form>
                {% endif %}
            </div>
            
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div class="upload-progress-container" id="uploadProgress">
                <div class="upload-progress-label">–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</div>
                <div class="upload-progress-bar">
                    <div class="upload-progress-fill" id="uploadProgressFill">0%</div>
                </div>
                <div class="upload-progress-text" id="uploadProgressText">–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ...</div>
            </div>
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ -->
            <div class="transcription-progress-container" id="transcriptionProgress">
                <div class="transcription-progress-header">
                    <div class="transcription-progress-title" id="transcriptionFileName">–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...</div>
                    <span class="transcription-status status-processing" id="transcriptionStatus">–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è</span>
                </div>
                <div class="transcription-progress-bar">
                    <div class="transcription-progress-fill" id="transcriptionProgressFill"></div>
                </div>
                <div class="transcription-progress-text" id="transcriptionProgressText">
                    <span class="spinner" style="display: inline-block; width: 16px; height: 16px; border-width: 3px;"></span>
                    –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è...
                </div>
            </div>
        </div>
        
        <div class="transcriptions-section">
            <h2>–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏</h2>
            <div id="transcriptionsList">
                {% if transcriptions %}
                    {% for transcription in transcriptions %}
                    <div class="transcription-item" data-id="{{ transcription.id }}">
                        <div class="transcription-header">
                            <span class="transcription-filename">{{ transcription.filename }}</span>
                            <span class="status-badge status-{{ transcription.status }}">
                                {% if transcription.status == 'pending' %}–æ–∂–∏–¥–∞–µ—Ç
                                {% elif transcription.status == 'processing' %}–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
                                {% elif transcription.status == 'completed' %}–∑–∞–≤–µ—Ä—à–µ–Ω–æ
                                {% elif transcription.status == 'error' %}–æ—à–∏–±–∫–∞
                                {% endif %}
                            </span>
                        </div>
                        <div class="transcription-meta">
                            <span>üìÖ {{ transcription.uploaded_at|date:"d.m.Y H:i" }}</span>
                            <span>üåê {{ transcription.ip_address }}</span>
                            {% if transcription.signature %}
                            <span>‚úçÔ∏è {{ transcription.signature }}</span>
                            {% endif %}
                            <span>üì¶ {{ transcription.file_size|filesizeformat }}</span>
                        </div>
                        {% if transcription.status == 'completed' and transcription.transcribed_text %}
                        <div class="transcription-preview">
                            {{ transcription.transcribed_text|truncatewords:30 }}
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
                            <a href="{% url 'transcription_detail' transcription.id %}" class="view-full">—á–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Üí</a>
                            <a href="{% url 'download_text' transcription.id %}" class="view-full" style="background: #4d9de0;">üìÑ —Å–∫–∞—á–∞—Ç—å —Ç–µ–∫—Å—Ç</a>
                        </div>
                        {% elif transcription.status == 'processing' %}
                        <div class="transcription-preview">
                            <span class="spinner" style="display: inline-block; width: 16px; height: 16px; border-width: 3px;"></span>
                            –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...
                        </div>
                        {% elif transcription.status == 'error' %}
                        <div class="transcription-preview">
                            <p style="color: #000; font-weight: 900;">‚ùå –æ—à–∏–±–∫–∞: {{ transcription.error_message }}</p>
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-state">
                        <p>–ø–æ–∫–∞ –Ω–µ—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π. –∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª!</p>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å–∫–µ -->
        <div class="disk-info" id="diskInfo">
            <div class="disk-info-header" onclick="toggleDiskInfo()">
                <div class="disk-info-title">üíæ —Å–≤–æ–±–æ–¥–Ω–æ –Ω–∞ –¥–∏—Å–∫–µ</div>
                <button class="disk-info-toggle" onclick="event.stopPropagation(); toggleDiskInfo();">‚àí</button>
            </div>
            <div class="disk-info-content">
                <div class="disk-info-value">{{ disk_info.free_gb|floatformat:1 }} –ì–ë</div>
                <div class="disk-bar">
                    <div class="disk-bar-fill {% if disk_info.used_percent > 80 %}danger{% elif disk_info.used_percent > 60 %}warning{% endif %}" 
                         style="width: {{ disk_info.used_percent }}%"></div>
                </div>
                <div style="font-size: 10px; margin-top: 5px; opacity: 0.7;">
                    –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: {{ disk_info.used_percent|floatformat:1 }}%
                </div>
                <button class="disk-clear-btn" onclick="showClearDiskModal()">–æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –¥–∏—Å–∫</button>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–∞—Ä–æ–ª—è -->
        <div class="password-modal" id="passwordModal">
            <div class="password-modal-content">
                <h3>‚ö†Ô∏è –æ—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–∞</h3>
                <p style="margin-bottom: 15px; font-weight: 700;">–≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:</p>
                <input type="password" id="adminPassword" placeholder="–ø–∞—Ä–æ–ª—å —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞" autocomplete="off">
                <div class="password-modal-buttons">
                    <button class="password-modal-btn confirm" onclick="confirmClearDisk()">–æ—á–∏—Å—Ç–∏—Ç—å</button>
                    <button class="password-modal-btn cancel" onclick="closePasswordModal()">–æ—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const form = document.getElementById('uploadForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const btnSpinner = document.getElementById('btnSpinner');
        const message = document.getElementById('message');
        const uploadProgress = document.getElementById('uploadProgress');
        const uploadProgressFill = document.getElementById('uploadProgressFill');
        const uploadProgressText = document.getElementById('uploadProgressText');
        const transcriptionProgress = document.getElementById('transcriptionProgress');
        const transcriptionProgressFill = document.getElementById('transcriptionProgressFill');
        const transcriptionProgressText = document.getElementById('transcriptionProgressText');
        const transcriptionFileName = document.getElementById('transcriptionFileName');
        const transcriptionStatus = document.getElementById('transcriptionStatus');
        
        let currentTranscriptionId = null;
        let statusCheckInterval = null;
        
        // –£–ª—É—á—à–µ–Ω–Ω—ã–π drag and drop
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('file');
        const fileList = document.getElementById('fileList');
        let selectedFiles = [];
        
        // –ö–ª–∏–∫ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤
        fileInput.addEventListener('change', (e) => {
            handleFiles(Array.from(e.target.files));
        });
        
        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                handleFiles(Array.from(e.dataTransfer.files));
            }
        });
        
        function handleFiles(files) {
            const maxSize = 500 * 1024 * 1024;
            const validFiles = [];
            
            files.forEach(file => {
                if (file.size > maxSize) {
                    showMessage(`—Ñ–∞–π–ª ${file.name} —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å: 500 –º–±)`, 'error');
                } else {
                    validFiles.push(file);
                }
            });
            
            selectedFiles = [...selectedFiles, ...validFiles];
            updateFileList();
        }
        
        function updateFileList() {
            fileList.innerHTML = '';
            
            if (selectedFiles.length === 0) {
                uploadArea.querySelector('.upload-text').innerHTML = '<strong>–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</strong><br>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞';
                return;
            }
            
            uploadArea.querySelector('.upload-text').innerHTML = `<strong>–≤—ã–±—Ä–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: ${selectedFiles.length}</strong>`;
            
            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <span class="file-item-name">${file.name}</span>
                    <span class="file-item-size">${formatBytes(file.size)}</span>
                    <button type="button" class="file-item-remove" onclick="removeFile(${index})">‚úï</button>
                `;
                fileList.appendChild(fileItem);
            });
        }
        
        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFileList();
        }
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (selectedFiles.length === 0) {
                showMessage('–ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª—ã', 'error');
                return;
            }
            
            submitBtn.disabled = true;
            btnText.textContent = '–∑–∞–≥—Ä—É–∑–∫–∞...';
            btnSpinner.style.display = 'inline-block';
            message.classList.remove('active');
            uploadProgress.classList.add('active');
            transcriptionProgress.classList.remove('active');
            
            const formData = new FormData(form);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
            selectedFiles.forEach(file => {
                formData.append('file', file);
            });
            
            const totalSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);
            const fileNames = selectedFiles.map(f => f.name).join(', ');
            
            // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
            let uploadProgressValue = 0;
            const uploadInterval = setInterval(() => {
                uploadProgressValue += Math.random() * 15;
                if (uploadProgressValue > 90) uploadProgressValue = 90;
                updateUploadProgress(uploadProgressValue, `–∑–∞–≥—Ä—É–∂–µ–Ω–æ ${formatBytes(totalSize * uploadProgressValue / 100)} –∏–∑ ${formatBytes(totalSize)} (${files.length} —Ñ–∞–π–ª${files.length > 1 ? '–æ–≤' : ''})`);
            }, 200);
            
            try {
                const xhr = new XMLHttpRequest();
                
                xhr.upload.addEventListener('progress', (e) => {
                    if (e.lengthComputable) {
                        const percentComplete = (e.loaded / e.total) * 100;
                        updateUploadProgress(percentComplete, `–∑–∞–≥—Ä—É–∂–µ–Ω–æ ${formatBytes(e.loaded)} –∏–∑ ${formatBytes(e.total)}`);
                    }
                });
                
                xhr.addEventListener('load', () => {
                    clearInterval(uploadInterval);
                    if (xhr.status === 200) {
                        const data = JSON.parse(xhr.responseText);
                        if (data.success) {
                            updateUploadProgress(100, `–∑–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: ${data.count || 1}`);
                            showMessage(`—É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: ${data.count || 1}. –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—á–∞–ª–∞—Å—å.`, 'success');
                            setTimeout(() => {
                                uploadProgress.classList.remove('active');
                                window.location.reload();
                            }, 2000);
                        } else {
                            throw new Error(data.error || '–æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ');
                        }
                    } else {
                        throw new Error('–æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                    }
                });
                
                xhr.addEventListener('error', () => {
                    clearInterval(uploadInterval);
                    throw new Error('–æ—à–∏–±–∫–∞ —Å–µ—Ç–∏');
                });
                
                xhr.open('POST', '/upload/');
                xhr.setRequestHeader('X-CSRFToken', document.querySelector('[name=csrfmiddlewaretoken]').value);
                xhr.send(formData);
                
            } catch (error) {
                clearInterval(uploadInterval);
                showMessage('–æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞: ' + error.message, 'error');
                resetForm();
            }
        });
        
        function updateUploadProgress(percent, text) {
            uploadProgressFill.style.width = percent + '%';
            uploadProgressFill.textContent = Math.round(percent) + '%';
            uploadProgressText.textContent = text;
        }
        
        function startTranscriptionProgress(transcriptionId, fileName) {
            currentTranscriptionId = transcriptionId;
            transcriptionProgress.classList.add('active');
            transcriptionFileName.textContent = fileName;
            transcriptionStatus.textContent = '–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è';
            transcriptionStatus.className = 'transcription-status status-processing';
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (—Å–∏–º—É–ª—è—Ü–∏—è)
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 2;
                if (progress > 95) progress = 95;
                transcriptionProgressFill.style.width = progress + '%';
            }, 500);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
            statusCheckInterval = setInterval(async () => {
                try {
                    const response = await fetch(`/transcription/${transcriptionId}/status/`);
                    const data = await response.json();
                    
                    if (data.status === 'completed') {
                        clearInterval(statusCheckInterval);
                        clearInterval(progressInterval);
                        transcriptionProgressFill.style.width = '100%';
                        transcriptionStatus.textContent = '–∑–∞–≤–µ—Ä—à–µ–Ω–æ';
                        transcriptionStatus.className = 'transcription-status status-completed';
                        transcriptionProgressText.innerHTML = '‚úÖ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!';
                        showMessage('—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                    } else if (data.status === 'error') {
                        clearInterval(statusCheckInterval);
                        clearInterval(progressInterval);
                        transcriptionStatus.textContent = '–æ—à–∏–±–∫–∞';
                        transcriptionStatus.className = 'transcription-status status-error';
                        transcriptionProgressText.textContent = '‚ùå ' + (data.error || '–ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞');
                        showMessage('–æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                        resetForm();
                    } else if (data.status === 'processing') {
                        transcriptionProgressText.innerHTML = '<span class="spinner" style="display: inline-block; width: 16px; height: 16px; border-width: 3px;"></span> –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...';
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞:', error);
                }
            }, 3000); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        }
        
        function resetForm() {
            submitBtn.disabled = false;
            btnText.textContent = '–∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å';
            btnSpinner.style.display = 'none';
            uploadProgress.classList.remove('active');
            if (statusCheckInterval) {
                clearInterval(statusCheckInterval);
            }
        }
        
        function showMessage(text, type) {
            message.textContent = text;
            message.className = 'message ' + type + ' active';
            setTimeout(() => {
                message.classList.remove('active');
            }, 5000);
        }
        
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥–∏—Å–∫–µ
        function toggleDiskInfo() {
            const diskInfo = document.getElementById('diskInfo');
            const toggle = diskInfo.querySelector('.disk-info-toggle');
            diskInfo.classList.toggle('collapsed');
            toggle.textContent = diskInfo.classList.contains('collapsed') ? '+' : '‚àí';
        }
        
        // –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∏—Å–∫–∞
        function showClearDiskModal() {
            document.getElementById('passwordModal').classList.add('active');
            document.getElementById('adminPassword').focus();
        }
        
        function closePasswordModal() {
            document.getElementById('passwordModal').classList.remove('active');
            document.getElementById('adminPassword').value = '';
        }
        
        function confirmClearDisk() {
            const password = document.getElementById('adminPassword').value;
            if (!password) {
                alert('–≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å');
                return;
            }
            
            fetch('/clear-disk/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({password: password})
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('–¥–∏—Å–∫ –æ—á–∏—â–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                    closePasswordModal();
                    window.location.reload();
                } else {
                    alert('–æ—à–∏–±–∫–∞: ' + (data.error || '–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å'));
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –¥–∏—Å–∫–∞');
            });
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
        document.getElementById('passwordModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closePasswordModal();
            }
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePasswordModal();
            }
        });
        
        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏—Ö—Å—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π –≤ —Å–ø–∏—Å–∫–µ
        const processingItems = document.querySelectorAll('.transcription-item[data-id]');
        processingItems.forEach(item => {
            const status = item.querySelector('.status-badge');
            if (status && status.classList.contains('status-processing')) {
                const id = item.getAttribute('data-id');
                setInterval(async () => {
                    try {
                        const response = await fetch(`/transcription/${id}/status/`);
                        const data = await response.json();
                        if (data.status === 'completed' || data.status === 'error') {
                            window.location.reload();
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞:', error);
                    }
                }, 5000);
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ –ø–æ —Ñ—Ä–∞–∑–µ-–ø–∞—Ä–æ–ª—é
        const loginForm = document.getElementById('loginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData(loginForm);
                
                try {
                    const response = await fetch('/login/', {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                        }
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        showMessage('–≤—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else {
                        showMessage(data.error || '–æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ', 'error');
                    }
                } catch (error) {
                    showMessage('–æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ: ' + error.message, 'error');
                }
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Ö–æ–¥–∞
        const logoutForm = document.getElementById('logoutForm');
        if (logoutForm) {
            logoutForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                try {
                    const response = await fetch('/logout/', {
                        method: 'POST',
                        headers: {
                            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: 'csrfmiddlewaretoken=' + document.querySelector('[name=csrfmiddlewaretoken]').value
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        showMessage('–≤—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 1000);
                    } else {
                        showMessage(data.error || '–æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ', 'error');
                    }
                } catch (error) {
                    showMessage('–æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ: ' + error.message, 'error');
                }
            });
        }
    </script>
</body>
</html>

